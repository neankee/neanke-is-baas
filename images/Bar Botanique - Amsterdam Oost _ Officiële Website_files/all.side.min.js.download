var FT;!function(a){!function(a){!function(a){var b=function(){function a(){}return a}();a.Settings=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(a,b,c){c.state("toolbar",{abstract:!0,resolve:{translationsLoaded:["$translate","$stateParams",function(a,b){return a.getApiPromise(b.uid,b.culture).then(function(a){return a})}]},views:{main:{controller:"toolbarController",controllerAs:"ctrl",templateUrl:"/app/widgets/side/views/toolbar.html"}}}),c.state("book",{cache:!1,url:"/side/:culture/:uid/book?voucherCode",templateUrl:"/app/widgets/side/views/book.html",controller:"bookController",controllerAs:"ctrl",parent:"toolbar"}),c.state("redeem",{url:"/side/:culture/:uid/redeem",templateUrl:"/app/widgets/side/views/redeem.html",controller:"redeemController",controllerAs:"ctrl",parent:"toolbar"}),c.state("ticket",{cache:!1,url:"/side/:culture/:uid/ticket/:ticketId",templateUrl:"/app/widgets/side/views/ticket.html",controller:"ticketController",controllerAs:"ctrl",params:{from:null},parent:"toolbar"}),c.state("vouchers",{url:"/side/:culture/:uid/vouchers",templateUrl:"/app/widgets/side/views/vouchers.html",controller:"vouchersController",controllerAs:"ctrl",parent:"toolbar"}),c.state("takeaway",{url:"/side/:culture/:uid/takeaway",templateUrl:"/app/widgets/side/views/takeaway.html",controller:"takeAwayController",controllerAs:"ctrl",parent:"toolbar"}),c.state("terms",{url:"/side/:culture/:uid/terms",templateUrl:"/app/widgets/side/views/terms.html",controller:"termsController",controllerAs:"ctrl",parent:"toolbar"}),c.state("help",{url:"/side/:culture/:uid/help",templateUrl:"/app/widgets/side/views/help.html",controller:"helpController",controllerAs:"ctrl",parent:"toolbar"}),c.state("group",{url:"/side/:culture/:uid/group",templateUrl:"/app/widgets/side/views/group.html",controller:"groupController",controllerAs:"ctrl",parent:"toolbar"}),c.state("error",{url:"/side/:culture/:uid/error",params:{errorMessage:null,errorCode:null},templateUrl:"/app/widgets/side/views/error.html",controller:"errorController",controllerAs:"ctrl",parent:"toolbar"}),c.state("checkout",{url:"/side/:culture/:uid/checkout",templateUrl:"/app/widgets/side/views/checkout.html",controller:"checkoutController",controllerAs:"ctrl",parent:"toolbar"}),c.state("voucherCheckout",{url:"/side/:culture/:uid/voucher/checkout/:productUid",templateUrl:"/app/widgets/side/views/voucherCheckout.html",controller:"voucherCheckoutController",controllerAs:"ctrl",parent:"toolbar",resolve:{product:["apiService","$stateParams",function(a,b){return b.productUid?a.getProduct(b.uid,b.productUid,b.culture).then(function(a){return a.data}):null}]}}),c.state("takeAwayCheckout",{url:"/side/:culture/:uid/takeaway/checkout",templateUrl:"/app/widgets/side/views/takeAwayCheckout.html",controller:"takeAwayCheckoutController",controllerAs:"ctrl",parent:"toolbar",resolve:{product:["apiService","$stateParams",function(a,b){return b.productUid?a.getProduct(b.uid,b.productUid,b.culture).then(function(a){return a.data}):null}]}}),c.state("option",{url:"/side/:culture/:uid/option?optionId&accept&message",templateUrl:"/app/widgets/side/views/option.html",controller:"optionController",controllerAs:"ctrl",parent:"toolbar"}),c.state("finish",{url:"/side/:culture/:uid/finish?booking&type&paymentRequired&option-action&ft-booking&order",templateUrl:"/app/widgets/side/views/finish.html",controller:"finishController",controllerAs:"ctrl",parent:"toolbar"}),c.state("voucherFinish",{url:"/side/:culture/:uid/voucher/finish?type&order&paymentRequired",templateUrl:"/app/widgets/side/views/voucherFinish.html",controller:"voucherFinishController",controllerAs:"ctrl",parent:"toolbar"}),c.state("takeAwayFinish",{url:"/side/:culture/:uid/takeAway/finish?type&order&paymentRequired",templateUrl:"/app/widgets/side/views/takeAwayFinish.html",controller:"takeAwayFinishController",controllerAs:"ctrl",parent:"toolbar"}),c.state("unsubscribe",{url:"/side/:culture/:uid/unsubscribe?email&code&recipientId",templateUrl:"/app/widgets/side/views/unsubscribe.html",controller:"unsubscribeController",controllerAs:"ctrl",parent:"toolbar"}),c.state("subscribe",{url:"/side/:culture/:uid/subscribe?email&code",templateUrl:"/app/widgets/side/views/subscribe.html",controller:"subscribeController",controllerAs:"ctrl",parent:"toolbar"}),b.html5Mode({enabled:!0,requireBase:!1})}return a.$inject=["$routeProvider","$locationProvider","$stateProvider"],a}();a.RouteConfig=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide",["ngRoute","ngTouch","ui.router","ngAnimate","ngStorage","angular.filter","ft.translate","debounce","ng-clamp","ft.signal","ngSanitize"]).value("settings",new FT.Widget.Side.Settings).constant("translationContext","widget").config(FT.Widget.Side.RouteConfig).config(["$translateProvider","$animateProvider","signalRServiceProvider","signalRUrl","widgetApiUrl","translationUrl","translationContext",function(a,b,c,d,e,f,g){b.classNameFilter(/angular-animate/),c.setLogging(!1),c.setConnectionUrl(d+"/widget-hub"),a.setup(e,f,g)}]).run(["$transitions","$rootScope","cssService","$injector",function(a,b,c,d){FastClick.attach(document.body),a.onStart({},function(a){b.stateTo=a.$to().name,b.stateFrom=a.$from().name,$(".widget-container").attr("animate-from",a.$from().name),$(".widget-container").attr("animate-to",a.$to().name)}),a.onSuccess({},function(a){var b=a.$to().name,e=a.$from().name;"book"==a.$from().name?c.removeClass("ft-w-page-"+d.get("widgetService").bookView):c.removeClass("ft-w-page-"+e),"book"==a.$to().name?c.addClass("ft-w-page-"+d.get("widgetService").bookView):c.addClass("ft-w-page-"+b)})}]);var FT;!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d,e){this.$stateParams=a,this.apiService=b,this.widgetService=c,this.timespanService=d,this.$state=e,this.voucherDiscount=0,this.totalAmount=0,c.voucher&&this.setVoucher(this.widgetService.voucher),this.ticket&&"-1"!==this.ticket.refundPolicy&&"0"!==this.ticket.refundPolicy&&(this.ticketUntilTimeSpan=this.timespanService.toString(this.ticket.refundPolicy)),this.calculateAmounts()}return a.prototype.applyVoucherCode=function(){var a=this;this.widgetService.checkVoucherCode(this.voucherCode).then(function(b){b?a.setVoucher(a.widgetService.voucher):(a.invalidVoucherCode=!0,a.calculateAmounts())})},a.prototype.setVoucher=function(a){this.voucher=a,this.voucherCode=a.code,a.ticket&&this.ticket&&a.ticket.uid!==this.ticket.uid||a.ticket&&!this.ticket?(this.voucher.invalid=!0,this.invalidVoucherTicket=!0):a.ticket&&a.quantity>this.booking.numberOfPeople?(this.voucher.invalid=!0,this.invalidVoucherNumberOfPeople=!0):(this.voucher=a,this.voucherCode=a.code,this.voucher.invalid=!1,this.calculateAmounts())},a.prototype.goToVoucherTicket=function(){this.$state.go("ticket",{ticketId:this.widgetService.voucher.ticket.uid,uid:this.widgetService.restaurant.uid,culture:this.booking.culture})},a.prototype.removeVoucher=function(){this.voucher.invalid=!0,this.invalidVoucherTicket=!1,this.invalidVoucherNumberOfPeople=!1,this.invalidVoucherCode=!1,this.voucher=null,this.voucherCode=null,this.calculateAmounts()},a.prototype.calculateAmounts=function(){if(!this.ticket)return this.totalAmount=0,void(this.quantity=this.booking.numberOfPeople);this.voucher&&!this.voucher.invalid?this.voucher.ticket?(this.quantity=this.booking.numberOfPeople-this.voucher.quantity,this.totalAmount=this.quantity*this.ticket.price):(this.quantity=this.booking.numberOfPeople,this.totalAmount=this.quantity*this.ticket.price-this.voucher.price):(this.quantity=this.booking.numberOfPeople,this.totalAmount=this.quantity*this.ticket.price)},a.prototype.getTillTime=function(){return moment(this.widgetService.dateFromBooking(this.booking)).add(this.booking.bookingDuration,"minutes").format("LT")},a.$inject=["$stateParams","apiService","widgetService","timeSpanService","$state"],a}(),c=function(){function a(){this.bindings={booking:"<",ticket:"<",restaurant:"<",voucher:"=",totalAmount:"=",showDescription:"<"},this.controller=b,this.templateUrl="/app/widgets/side/components/checkoutSummary.html"}return a}();angular.module("widgetSide").component("checkoutSummary",new c)}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d){this.$stateParams=a,this.webUrl=b,this.widgetService=c,this.timespanService=d}return a.$inject=["$stateParams","webUrl","widgetService","timeSpanService","$filter"],a}(),c=function(){function a(){this.bindings={model:"="},this.controller=b,this.templateUrl="/app/widgets/side/components/checkoutTerms.html"}return a}();angular.module("widgetSide").component("checkoutTerms",new c)}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d,e){this.$element=a,this.$scope=b,this.widgetService=c,this.$filter=d,this.$stateParams=e}return a.$inject=["$element","$scope","widgetService","$filter","$stateParams"],a}(),c=function(){function a(){this.bindings={voucher:"<",restaurant:"<"},this.controller=b,this.templateUrl="/app/widgets/side/components/voucherInfo.html"}return a}();angular.module("widgetSide").component("voucherInfo",new c)}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l){var m=this;this.$scope=a,this.$http=b,this.$state=c,this.$stateParams=d,this.$location=e,this.$timeout=f,this.$route=g,this.$localStorage=h,this.widgetService=i,this.apiService=j,this.cssService=k,this.sdkService=l,this.voucherCode="",this.weekDays=[moment.weekdaysShort(1),moment.weekdaysShort(2),moment.weekdaysShort(3),moment.weekdaysShort(4),moment.weekdaysShort(5),moment.weekdaysShort(6),moment.weekdaysShort(0)],this.showCalendar=!1,this.showPeople=!1,this.showTimes=!1,d.voucherCode&&this.widgetService.checkVoucherCode(d.voucherCode).then(function(a){a&&m.widgetService.voucher.ticket&&(m.widgetService.booking.numberOfPeople=m.widgetService.voucher.quantity,m.$state.go("ticket",{ticketId:m.widgetService.voucher.ticket.uid,uid:m.uid,culture:m.culture}))}),this.$scope.$watch(function(){return Number(m.showCalendar)+Number(m.showPeople)+Number(m.showTimes)},function(a,b){b!==a&&(a>0?m.cssService.addClass("ft-w-select-open"):m.cssService.removeClass("ft-w-select-open"))},!1),this.$scope.$on("searchReady",function(){m.widgetService.searchTickets()}),this.widgetService.restaurantLoaded().then(function(a){m.restaurant=a}),this.initialize()}return a.prototype.initialize=function(){this.cssService.small(),this.widgetService.ticketOnly=!1,this.culture=this.$stateParams.culture,this.uid=this.$stateParams.uid,this.currentBooking=this.widgetService.booking,this.widgetService.selectedTicket=null,"search"===this.widgetService.bookView&&this.sdkService.call("event",["ft-widget-navigated",{productType:"ticket",widgetUid:this.sdkService.getWidgetId(),page:"search"}],!0)},a.prototype.closeWidget=function(){"search"===this.widgetService.bookView?(this.widgetService.bookView="suggested",this.cssService.removeClass("ft-w-page-search"),this.cssService.addClass("ft-w-page-suggested")):this.cssService.close()},a.prototype.openSelect=function(a){var b=this;a="show"+a,this[a]?this[a]=!1:(this.showCalendar=!1,this.showPeople=!1,this.showTimes=!1,this[a]=!0,$(".widget-container").on("click."+a,function(c){b[a]=!1,b.$scope.$apply(),$(".widget-container").off("click."+a)}))},a.prototype.getTillTime=function(a){return moment(a.time).add(a.maxDuration,"minutes").format("LT")},a.prototype.setPeople=function(a){this.widgetService.searchParams.numberOfPeople=a,this.showPeople=!1},a.prototype.bookDirect=function(){this.currentBooking.numberOfPeople=this.widgetService.searchParams.numberOfPeople,this.currentBooking.bookingTime=this.widgetService.searchParams.bookingTime,this.currentBooking.bookingDate=this.widgetService.searchParams.bookingDate,this.currentBooking.short=this.widgetService.searchParams.short,this.currentBooking.bookingDuration=this.widgetService.searchParams.bookingDuration,this.widgetService.selectedTicket=this.widgetService.result[0],this.$state.go("checkout",{uid:this.uid,culture:this.culture})},a.prototype.setTime=function(a){this.widgetService.setParams(a,!1),this.showTimes=!1},a.prototype.getOptionQuantity=function(){return this.widgetService.result.length},a.prototype.goToTicket=function(a,b){var c=this;this.showPeople||this.showCalendar||this.showTimes||(!a.default&&a.description||!b?this.$state.go("ticket",{ticketId:a.uid,uid:this.uid,culture:this.culture,from:this.widgetService.bookView}):this.apiService.getFirstDateTime(this.widgetService.restaurant,this.widgetService.dateFromBooking(this.widgetService.searchParams),this.culture,this.widgetService.searchParams.numberOfPeople,a.uid,this.widgetService.friendCode,this.widgetService.voucher?this.widgetService.voucher.code:"").then(function(b){var d=b.data;c.currentBooking.numberOfPeople=c.widgetService.searchParams.numberOfPeople,c.widgetService.setBookingTimes(d,!0),c.widgetService.selectedTicket=a,c.$state.go("checkout",{uid:c.uid,culture:c.culture})}))},a.prototype.searchTickets=function(){this.widgetService.bookView="search",this.cssService.removeClass("ft-w-page-suggested"),this.cssService.addClass("ft-w-page-search"),this.sdkService.call("event",["ft-widget-navigated",{widgetUid:this.sdkService.getWidgetId(),page:"search",productType:"ticket"}],!0)},a.$inject=["$scope","$http","$state","$stateParams","$location","$timeout","$route","$localStorage","widgetService","apiService","cssService","sdkService"],a}();a.BookController=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").controller("bookController",FT.Widget.Side.BookController);var FT;!function(a){!function(b){!function(b){var c=function(){function b(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){this.$filter=a,this.$scope=b,this.$rootScope=c,this.$http=d,this.$state=e,this.$stateParams=f,this.$location=g,this.$timeout=h,this.$route=i,this.$localStorage=j,this.widgetService=k,this.apiService=l,this.timeSpanService=m,this.cssService=n,this.checkoutService=o,this.sdkService=p,this.submitting=!1,this.totalAmount=0,this.initialize()}return b.prototype.initialize=function(){var b=this;this.cssService.full(),this.culture=this.$stateParams.culture,this.uid=this.$stateParams.uid,this.currentBooking=this.widgetService.booking,this.selectedTicket=this.widgetService.selectedTicket,this.restaurant=this.widgetService.restaurant,this.$localStorage.title&&(this.currentBooking.title=this.$localStorage.title),this.currentBooking.tags=new Array,this.currentBooking.company="true"===this.$localStorage.company,this.currentBooking.companyName=this.$localStorage.companyName,this.currentBooking.firstName=this.$localStorage.firstName,this.currentBooking.lastName=this.$localStorage.lastName,this.currentBooking.email=this.$localStorage.email,this.currentBooking.telephone=this.$localStorage.telephone,a.Helpers.StorageHelper.storageAvailable("sessionStorage")&&(sessionStorage.setItem("ticket",JSON.stringify(this.selectedTicket)),sessionStorage.setItem("booking",JSON.stringify(this.currentBooking))),this.$scope.$watch(function(){return b.totalAmount},function(){b.getPaymentMethods()});var c={widgetUid:this.sdkService.getWidgetId(),productType:"ticket",page:"checkout"};this.selectedTicket&&(c.products=[{type:"ticket",title:this.selectedTicket.title,uid:this.selectedTicket.uid,amount:this.selectedTicket.price/100,quantity:this.currentBooking.numberOfPeople}]),this.sdkService.call("event",["ft-widget-navigated",c],!0)},b.prototype.checkHouseHold=function(){return this.currentBooking.numberOfPeople>2&&!this.widgetService.restaurant.features.some(function(a){return"DISABLE_COVID_CHECK"==a})},b.prototype.checkCanHouseHoldBook=function(){return!!this.widgetService.restaurant.features.some(function(a){return"DISABLE_COVID_CHECK"==a})||(this.currentBooking.numberOfPeople<=2||(!!this.singleHousehold||this.currentBooking.numberOfPeople>2&&!this.widgetService.restaurant.features.some(function(a){return"ONLY_ACCEPT_SINGLE_HOUSEHOLD"==a})))},b.prototype.getIdealIssuers=function(){var a=this;this.apiService.getIdealIssuers(this.widgetService.restaurant).then(function(b){a.issuers=b.data})},b.prototype.getPaymentMethods=function(){var a=this;this.totalAmount>0&&this.apiService.getPaymentMethods(this.widgetService.restaurant,this.totalAmount).then(function(b){a.paymentMethods=b.data,1===a.paymentMethods.length&&a.selectMethod(a.paymentMethods[0])})},b.prototype.selectMethod=function(a){this.paymentMethod=a,"ideal"!==a.id||this.issuers||this.getIdealIssuers()},b.prototype.checkout=function(){if(this.submitting=!0,this.btnDisable=!0,this.currentBooking.numberOfPeople>2&&!this.widgetService.restaurant.features.some(function(a){return"DISABLE_COVID_CHECK"==a})){var a=this.currentBooking.tags.indexOf("MULTIPLEHOUSEHOLDS");this.singleHousehold&&a>-1&&this.currentBooking.tags.splice(a),this.singleHousehold||-1!=a||this.currentBooking.tags.push("MULTIPLEHOUSEHOLDS")}this.$scope.checkout.$valid?this.checkoutService.createBooking(this.currentBooking,this.voucher?this.voucher.code:null,this.selectedTicket,this.paymentMethod,this.issuer):this.btnDisable=!1},b.$inject=["$filter","$scope","$rootScope","$http","$state","$stateParams","$location","$timeout","$route","$localStorage","widgetService","apiService","timeSpanService","cssService","checkoutService","sdkService"],b}();b.CheckoutController=c}(b.Side||(b.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").controller("checkoutController",FT.Widget.Side.CheckoutController);var FT;!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d,e,f,g,h,i,j){this.$scope=a,this.$http=b,this.$state=c,this.$stateParams=d,this.$location=e,this.$timeout=f,this.$route=g,this.$localStorage=h,this.widgetService=i,this.cssService=j,this.initialize()}return a.prototype.initialize=function(){this.culture=this.$stateParams.culture,this.uid=this.$stateParams.uid,this.restaurant=this.widgetService.restaurant,this.errorMessage=this.$stateParams.errorMessage,this.errorCode=this.$stateParams.errorCode,this.cssService.open()},a.$inject=["$scope","$http","$state","$stateParams","$location","$timeout","$route","$localStorage","widgetService","cssService"],a}();a.ErrorController=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").controller("errorController",FT.Widget.Side.ErrorController);var FT;!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n){this.$translate=a,this.signalRService=b,this.$scope=c,this.$http=d,this.$state=e,this.$stateParams=f,this.$location=g,this.$timeout=h,this.$route=i,this.$localStorage=j,this.widgetService=k,this.apiService=l,this.cssService=m,this.sdkService=n,this.initialize()}return a.prototype.initialize=function(){var a=this;this.cssService.full(),this.purchaseEventThrown=!1,this.checking=!0,this.culture=this.$stateParams.culture,this.firstTry=(new Date).getTime(),this.uid=this.$stateParams.uid,this.type=this.$stateParams.type,this.paymentRequired="true"==this.$stateParams.paymentRequired,this.bookingUid=this.$state.params.booking||this.$state.params["ft-booking"],this.signalRService.subscribe("reservation_"+this.bookingUid),this.$scope.$on("$destroy",function(){a.signalRService.unSubscribe("reservation_"+a.booking.uid)}),this.signalRService.addListener("paymentRedirect","finishController",function(b){a.paymentUrl=b,window.top.location.href=b}),this.signalRService.addListener("bookingChanged","finishController",function(b){("ACCEPTED"==b.status||"CREATED"==b.status&&b.optionExpiresDateTime)&&a.$timeout(function(){a.loadBooking(b.uid)},Math.max(0,a.firstTry+1e3-(new Date).getTime()))}),this.signalRService.addListener("bookingCancelled","finishController",function(b){a.$timeout(function(){a.loadBooking(b)},Math.max(0,a.firstTry+1e3-(new Date).getTime()))});var b="prepaid"==this.$state.params.type?3e3:6e3;this.$timeout(function(){a.checking&&(a.loadBooking(a.bookingUid),a.paymentRequired&&a.redirectToPayment())},b)},a.prototype.redirectToPayment=function(){var a=this;this.apiService.getPaymentUrlForBooking(this.bookingUid).then(function(b){b.data?(a.paymentUrl=b.data,window.top.location.href=a.paymentUrl):a.$timeout(function(){a.redirectToPayment()},5e3)})},a.prototype.goToPayment=function(){window.top.location.href=this.paymentUrl},a.prototype.loadBooking=function(a){var b=this;this.apiService.getBooking(this.widgetService.restaurant,a).then(function(c){if(b.booking=c.data,b.checking=!1,$(".ticket-screen").addClass("finished"),b.registerPageView(),b.booking.isOption&&b.booking.totalAmount&&"Open"!==b.booking.paymentStatus)return b.$state.go("option",{uid:b.$stateParams.uid,culture:b.$stateParams.culture,optionId:a,accept:!0,message:b.$translate.getTranslation("Your payment did not succeed. Please try again.")}),!1;"ACCEPTED"!==b.booking.status||b.purchaseEventThrown||b.registerPurchaseEvent()})},a.prototype.registerPageView=function(){var a={productType:"ticket",widgetUid:this.sdkService.getWidgetId(),page:"finish"};this.booking.ticket&&(a.products=[{type:"ticket",title:this.booking.ticket.title,uid:this.booking.ticket.uid,amount:this.booking.ticket.price,quantity:this.booking.numberOfPeople}]),this.sdkService.call("event",["ft-widget-navigated",a],!0)},a.prototype.registerPurchaseEvent=function(){if("ORDERED"===this.booking.orderStatus){var a={productType:"ticket",widgetUid:this.sdkService.getWidgetId(),order:{uid:this.booking.orderUid,totalAmount:this.booking.totalAmount/100,products:[]},reservation:{uid:this.booking.uid,numberOfPeople:this.booking.numberOfPeople,bookingDateTime:this.widgetService.dateFromBooking(this.booking),source:this.booking.source,culture:this.booking.culture}};this.booking.ticket?a.order.products=[{type:"ticket",title:this.booking.ticket.title,uid:this.booking.ticket.uid,amount:this.booking.ticket.price,quantity:this.booking.numberOfPeople}]:a.order.products=[{type:"regular",title:"Regular reservation",uid:"1",amount:0,quantity:this.booking.numberOfPeople}],this.sdkService.call("event",["ft-widget-ordered",a],!0),this.purchaseEventThrown=!0,a.page="success",this.sdkService.call("event",["ft-widget-navigated",a],!0)}},a.prototype.close=function(){var a=this;this.cssService.close(),this.$timeout(function(){a.widgetService.home()},500)},a.$inject=["$translate","signalRService","$scope","$http","$state","$stateParams","$location","$timeout","$route","$localStorage","widgetService","apiService","cssService","sdkService"],a}();a.FinishController=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").controller("finishController",FT.Widget.Side.FinishController);var FT;!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d,e,f,g,h,i,j){this.$scope=a,this.$http=b,this.$state=c,this.$stateParams=d,this.$location=e,this.$timeout=f,this.$route=g,this.$localStorage=h,this.widgetService=i,this.cssService=j,this.amount=0,this.initialize()}return a.prototype.initialize=function(){this.cssService.full(),this.culture=this.$stateParams.culture,this.uid=this.$stateParams.uid,this.currentBooking=this.widgetService.booking},a.$inject=["$scope","$http","$state","$stateParams","$location","$timeout","$route","$localStorage","widgetService","cssService"],a}();a.GroupController=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").controller("groupController",FT.Widget.Side.GroupController);var FT;!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d,e,f,g,h,i,j,k){this.$scope=a,this.$http=b,this.$state=c,this.$stateParams=d,this.$location=e,this.$timeout=f,this.$route=g,this.$localStorage=h,this.widgetService=i,this.cssService=j,this.sdkService=k,this.initialize()}return a.prototype.initialize=function(){this.cssService.full(),this.sdkService.call("event",["ft-widget-navigated",{widgetUid:this.sdkService.getWidgetId(),page:"help"}],!0),this.culture=this.$stateParams.culture,this.uid=this.$stateParams.uid,this.$timeout(function(){$('.help-index a[href^="#"], .help-content a[href^="#"]').on("click",function(a){a.preventDefault();var b=a.currentTarget.hash,c=$(b);c&&$(".screen-wrap").stop().animate({scrollTop:c.offset().top+$(".screen-wrap").scrollTop()-50},400,"swing",function(){})})},600)},a.$inject=["$scope","$http","$state","$stateParams","$location","$timeout","$route","$localStorage","widgetService","cssService","sdkService"],a}();a.HelpController=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").controller("helpController",FT.Widget.Side.HelpController);var FT;!function(a){!function(a){!function(a){var b=function(){function b(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){this.settings=a,this.$q=b,this.signalRService=c,this.$filter=d,this.reservationUrl=e,this.$scope=f,this.$rootScope=g,this.$http=h,this.$state=i,this.$stateParams=j,this.$location=k,this.$timeout=l,this.$route=m,this.$localStorage=n,this.widgetService=o,this.apiService=p,this.timeSpanService=q,this.cssService=r,this.checkoutService=s,this.sdkService=t,this.submitting=!1,this.totalAmount=0,this.loading=!0,this.btnDisable=!1,this.validationErrors=[],this.externalAccept=!0,this.initialize()}return b.prototype.initialize=function(){var a=this,b={productType:"ticket",widgetUid:this.sdkService.getWidgetId(),page:"option"};this.selectedTicket&&(b.products=[{type:"ticket",title:this.selectedTicket.title,uid:this.selectedTicket.uid,amount:this.selectedTicket.price/100,quantity:this.currentBooking.numberOfPeople}]),this.sdkService.call("event",["ft-widget-navigated",b],!0),this.culture=this.$stateParams.culture,this.uid=this.$stateParams.uid,this.externalAccept=this.$stateParams.accept,this.message=this.$stateParams.message,this.widgetService.restaurantLoaded().then(function(b){a.restaurant=b,a.loadOption(),a.signalRService.subscribe("reservation_"+a.$stateParams.optionId),a.signalRService.addListener("bookingChanged","optionController",function(b){a.message="",a.loadOption()}),a.signalRService.addListener("bookingCancelled","optionController",function(b){a.message="",a.loadOption()}),a.$scope.$on("$destroy",function(){a.signalRService.subscribe("reservation_"+a.$stateParams.optionId)})})},b.prototype.loadOption=function(){var a=this;this.apiService.getOption(this.widgetService.restaurant,this.$stateParams.optionId).then(function(b){a.cssService.full(),a.loading=!1;var c=b.data;a.widgetService.booking=a.currentBooking=b.data,a.widgetService.selectedTicket=a.selectedTicket=b.data.ticket,a.widgetService.selectedArea=c.areaName,a.status=new Date(a.widgetService.dateFromBooking(a.currentBooking))<new Date?"PASSED":c.status,a.currentBooking.tags=c.tags,a.currentBooking.company=c.company,a.currentBooking.companyName=c.companyName,a.currentBooking.title=c.title,a.currentBooking.firstName=c.firstName,a.currentBooking.lastName=c.lastName,a.currentBooking.email=c.email,a.currentBooking.telephone=c.telephone,0===a.currentBooking.optionExpiresDateTime.getHours()&&(a.currentBooking.optionExpiresDateTime=moment(a.currentBooking.optionExpiresDateTime).add("minutes",-1).toDate()),a.$scope.$watch(function(){return a.totalAmount},function(){a.getPaymentMethods()})})},b.prototype.openCancel=function(){this.externalAccept=!1},b.prototype.closeCancel=function(){this.externalAccept=!0},b.prototype.getIdealIssuers=function(){var a=this;this.apiService.getIdealIssuers(this.widgetService.restaurant).then(function(b){a.issuers=b.data})},b.prototype.getPaymentMethods=function(){var a=this;this.totalAmount>0&&this.apiService.getPaymentMethods(this.widgetService.restaurant,this.totalAmount).then(function(b){a.paymentMethods=b.data,1===a.paymentMethods.length&&a.selectMethod(a.paymentMethods[0])})},b.prototype.selectMethod=function(a){this.paymentMethod=a,"ideal"!==a.id||this.issuers||this.getIdealIssuers()},b.prototype.checkHouseHold=function(){return this.currentBooking.numberOfPeople>2&&!this.widgetService.restaurant.features.some(function(a){return"DISABLE_COVID_CHECK"==a})},b.prototype.accept=function(){var b=this;if(this.submitting=!0,this.btnDisable=!0,this.currentBooking.numberOfPeople>2&&!this.widgetService.restaurant.features.some(function(a){return"DISABLE_COVID_CHECK"==a})){var c=this.currentBooking.tags.indexOf("MULTIPLEHOUSEHOLDS");this.singleHousehold&&c>-1&&this.currentBooking.tags.splice(c),this.singleHousehold||-1!=c||this.currentBooking.tags.push("MULTIPLEHOUSEHOLDS")}if(this.$scope.checkout.$invalid)return void(this.btnDisable=!1);var d=new a.OptionAcceptModel;return d.booking=this.currentBooking,d.paymentMethodId=this.paymentMethod?this.paymentMethod.id:"",d.issuerId=this.issuer?this.issuer.id:"",d.returnUrl=this.settings.returnUrl,this.voucher&&(d.voucherCode=this.voucher.code),this.apiService.acceptOption(this.widgetService.restaurant,d).then(function(a){var c=a.data;b.checkoutService.saveLocalBookingData(b.currentBooking),c.paymentUrl?window.top.location.href=c.paymentUrl:b.$state.go("finish",{uid:b.$stateParams.uid,culture:b.$stateParams.culture,booking:b.currentBooking.uid,"option-action":"confirm",type:"option"})})},b.prototype.cancel=function(){var a=this;this.apiService.cancelOption(this.widgetService.restaurant,this.currentBooking.uid).then(function(b){a.$state.go("finish",{uid:a.$stateParams.uid,culture:a.$stateParams.culture,booking:a.currentBooking.uid,"option-action":"cancel",type:"option"})})},b.prototype.close=function(){var a=this;this.cssService.close(),this.$timeout(function(){a.widgetService.home()},500)},b.prototype.getTillTime=function(){return moment(this.widgetService.dateFromBooking(this.currentBooking)).add(this.currentBooking.bookingDuration,"minutes").format("LT")},b.prototype.isValid=function(a){return 0===this.validationErrors.filter(function(b){return b.field===a}).length},b.$inject=["settings","$q","signalRService","$filter","reservationUrl","$scope","$rootScope","$http","$state","$stateParams","$location","$timeout","$route","$localStorage","widgetService","apiService","timeSpanService","cssService","checkoutService","sdkService"],b}();a.OptionController=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").controller("optionController",FT.Widget.Side.OptionController);var FT;!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d,e,f,g){this.widgetService=a,this.$stateParams=b,this.$state=c,this.apiService=d,this.cssService=e,this.$timeout=f,this.sdkService=g,this.voucher=this.widgetService.voucher,this.$timeout(function(){$(".redeem-btn").focus()},200),this.sdkService.call("event",["ft-widget-navigated",{widgetUid:this.sdkService.getWidgetId(),page:"redeem",productType:"ticket"}],!0)}return a.prototype.checkVoucher=function(){var a=this;this.widgetService.checkVoucherCode(this.voucherCode).then(function(b){b?a.voucher=a.widgetService.voucher:a.message="This voucher is invalid."})},a.prototype.continue=function(){this.voucher.ticket?this.$state.go("ticket",{ticketId:this.voucher.ticket.uid,uid:this.$stateParams.uid,culture:this.$stateParams.culture}):this.$state.go("book",{uid:this.$stateParams.uid,culture:this.$stateParams.culture})},a.prototype.removeVoucher=function(){this.widgetService.voucher=this.voucher=this.voucherCode=null},a.$inject=["widgetService","$stateParams","$state","apiService","cssService","$timeout","sdkService"],a}();a.RedeemController=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").controller("redeemController",FT.Widget.Side.RedeemController);var FT;!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d,e,f){this.$state=a,this.$stateParams=b,this.$timeout=c,this.widgetService=d,this.apiService=e,this.cssService=f,this.initialize()}
return a.prototype.initialize=function(){this.culture=this.$stateParams.culture,this.uid=this.$stateParams.uid,this.email=this.$state.params.email||this.$state.params["ft-subscribe"],this.email&&(this.email=this.email.replace(/ /g,"+")),this.code=this.$state.params.code||this.$state.params["ft-code"],this.code&&this.confirmSubscription()},a.prototype.subscribe=function(){var a=this;this.apiService.subscribe(this.email,this.uid,this.culture).then(function(b){b.data&&(a.subscribed=!0)})},a.prototype.confirmSubscription=function(){var a=this;this.apiService.confirmSubscription(this.email,this.uid,this.code,this.culture).then(function(b){b.data&&(a.subscriptionConfirmed=!0)})},a.prototype.close=function(){var a=this;this.cssService.close(),this.$timeout(function(){a.widgetService.home()},500)},a.$inject=["$state","$stateParams","$timeout","widgetService","apiService","cssService"],a}();a.SubscribeController=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").controller("subscribeController",FT.Widget.Side.SubscribeController);var FT;!function(a){!function(b){!function(b){var c=function(){function c(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){var t=this;this.product=a,this.$filter=b,this.$interval=c,this.$scope=d,this.$rootScope=e,this.$http=f,this.$state=g,this.$stateParams=h,this.$location=i,this.$timeout=j,this.$route=k,this.$localStorage=l,this.widgetService=m,this.apiService=n,this.takeAwayService=o,this.cssService=p,this.checkoutService=q,this.sdkService=r,this.cart=s,this.terms=!1,this.submitting=!1,this.zipCodeInvalid=!1,this.itemsUnavailable=!1,this.timeSlotExpired=!1,this.btnDisable=!1,this.today=moment(new Date).add(-1,"days").toDate(),this.widgetService.restaurantLoaded().then(function(a){t.restaurant=a,t.initialize()})}return c.prototype.initialize=function(){var b=this;this.cssService.full();var c={productType:"takeaway",widgetUid:this.sdkService.getWidgetId(),page:"takeaway-checkout",products:[]};this.cart.products.length&&(this.cart.products.forEach(function(a){c.products.push({type:"takeaway",title:a.title,uid:a.uid,amount:a.price*a.quantity/100,quantity:a.quantity})}),"delivery"==this.cart.takeAwayMethod&&c.products.push({type:"takeaway",title:"Delivery",uid:"NA",amount:this.cart.getTotalAmount()-this.cart.getTotalWithoutDelivery()})),this.sdkService.call("event",["ft-widget-navigated",c],!0),this.culture=this.$stateParams.culture,this.uid=this.$stateParams.uid,this.$localStorage.title&&(this.cart.orderInfo.title=this.$localStorage.title),this.cart.orderInfo.company="true"===this.$localStorage.company,this.cart.orderInfo.companyName||(this.cart.orderInfo.companyName=this.$localStorage.companyName),this.cart.orderInfo.firstName||(this.cart.orderInfo.firstName=this.$localStorage.firstName),this.cart.orderInfo.lastName||(this.cart.orderInfo.lastName=this.$localStorage.lastName),this.cart.orderInfo.email||(this.cart.orderInfo.email=this.$localStorage.email),this.cart.orderInfo.telephone||(this.cart.orderInfo.telephone=this.$localStorage.telephone),this.cart.orderInfo.address||(this.cart.orderInfo.address=this.$localStorage.address),this.cart.orderInfo.zipcode||(this.cart.orderInfo.zipcode=this.$localStorage.zipcode),this.cart.orderInfo.city||(this.cart.orderInfo.city=this.$localStorage.city),this.cart.orderInfo.culture=this.culture,this.$scope.$watch(function(){return b.cart.products},function(a,c){b.cart.getTotalAmount()>0&&b.getPaymentMethods()},!0),this.$scope.$watch(function(){return b.cart.orderInfo.zipcode},function(a,c){b.zipCodeInvalid="delivery"==b.cart.takeAwayMethod&&!b.takeAwayService.validateZipcode(a)},!0),this.$scope.$watch(function(){return b.cart.takeAwayMethod},function(a,c){b.zipCodeInvalid="delivery"==a&&!b.takeAwayService.validateZipcode(b.cart.orderInfo.zipcode)},!0),this.$scope.$on("$destroy",function(){b.$interval.cancel(b.slotTimer)}),a.Helpers.StorageHelper.storageAvailable("sessionStorage")&&sessionStorage.setItem("product",JSON.stringify(this.product)),this.cart.paymentMethod&&"ideal"===this.cart.paymentMethod.id&&!this.issuers&&this.getIdealIssuers(),this.takeAwayService.preferredTimeIsAvailable(this.cart.preferredTime)||(this.cart.preferredTime=this.takeAwayService.getFirstAvailableTime()),this.selectedOrderTimeAvailable()},c.prototype.changeQuantity=function(a,b){a.quantity=Math.max(0,a.quantity+b),this.cart.updateProduct(a)},c.prototype.updateCartProductQuantity=function(){var a=this;this.apiService.getProducts(this.widgetService.restaurant.uid,this.$stateParams.culture,"TAKEAWAY",this.cart.preferredDate).then(function(b){var c=b.data;a.itemsUnavailable=!1,a.cart.products.forEach(function(b){var d=c.filter(function(a){return a.uid==b.uid})[0].availability;b.availability=d,null!=d&&b.quantity>d&&(b.quantity=d>0?d:0,a.itemsUnavailable=!0)})})},c.prototype.getIdealIssuers=function(){var a=this;this.apiService.getIdealIssuers(this.widgetService.restaurant).then(function(b){a.issuers=b.data})},c.prototype.getPaymentMethods=function(){var a=this;this.apiService.getPaymentMethods(this.widgetService.restaurant,this.cart.getTotalAmount(),"TAKEAWAY").then(function(b){a.paymentMethods=b.data,1===a.paymentMethods.length&&a.selectMethod(a.paymentMethods[0])})},c.prototype.selectMethod=function(a){this.cart.paymentMethod=a,"ideal"!==a.id||this.issuers||this.getIdealIssuers()},c.prototype.minOrderAmountValid=function(){return"delivery"==this.cart.takeAwayMethod&&this.takeAwayService.takeAwaySettings.minDeliveryOrderAmount&&this.takeAwayService.takeAwaySettings.minDeliveryOrderAmount>0?this.cart.getTotalAmount()>=this.takeAwayService.takeAwaySettings.minDeliveryOrderAmount:!("pick-up"==this.cart.takeAwayMethod&&this.takeAwayService.takeAwaySettings.minPickUpOrderAmount&&this.takeAwayService.takeAwaySettings.minPickUpOrderAmount>0)||this.cart.getTotalAmount()>=this.takeAwayService.takeAwaySettings.minPickUpOrderAmount},c.prototype.otherDayWarning=function(){return!moment().isSame(this.cart.preferredDate,"day")},c.prototype.checkout=function(){this.submitting=!0,this.btnDisable=!0,this.$scope.checkout.$valid?("delivery"!==this.cart.takeAwayMethod&&(this.cart.orderInfo.address=null,this.cart.orderInfo.zipcode=null,this.cart.orderInfo.city=null),this.checkoutService.createTakeAwayOrder(this.cart.orderInfo,new b.TakeAwayInfo(this.cart.takeAwayMethod,this.cart.orderInfo.comments,this.cart.preferredTime,this.cart.preferredDate),this.cart.products.map(function(a){return{productUid:a.uid,quantity:a.quantity}}),this.cart.paymentMethod,this.cart.issuer)):this.btnDisable=!1},c.prototype.selectedOrderTimeAvailable=function(){var a=this;this.slotTimer=this.$interval(function(){var b=a.cart.preferredTime;a.takeAwayService.updateTimes(a.cart.preferredDate,a.cart.takeAwayMethod).then(function(c){c.some(function(a){return a.time==b})||(a.timeSlotExpired=!0,a.cart.preferredTime=a.takeAwayService.getFirstAvailableTime())})},6e4)},c.prototype.dateFromTime=function(a,b){var c=a.split(":");return b.setHours(parseInt(c[0]),parseInt(c[1]),0,0)},c.prototype.canCheckout=function(){return this.cart.getTotalAmount()>0&&this.minOrderAmountValid()&&this.takeAwayService.timesAvailable()&&!this.zipCodeInvalid},c.$inject=["product","$filter","$interval","$scope","$rootScope","$http","$state","$stateParams","$location","$timeout","$route","$localStorage","widgetService","apiService","takeAwayService","cssService","checkoutService","sdkService","cartService"],c}();b.TakeAwayCheckoutController=c}(b.Side||(b.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").controller("takeAwayCheckoutController",FT.Widget.Side.TakeAwayCheckoutController);var FT;!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=this;this.$scope=a,this.$http=b,this.$state=c,this.$stateParams=d,this.$location=e,this.$timeout=f,this.$route=g,this.$localStorage=h,this.widgetService=i,this.apiService=j,this.cssService=k,this.sdkService=l,this.cart=m,this.takeAwayService=n,this.orderBy=function(a){return a.ticket?1e4*-a.price:-a.price},this.widgetService.restaurantLoaded().then(function(a){o.restaurant=a,o.takeAwayService.getTakeAwaySettings().then(function(a){o.takeAwayService.getFirstPossibleDate().then(function(a){o.cart.preferredDate||(o.cart.preferredDate=a),o.takeAwayService.updateTimes(o.cart.preferredDate,o.cart.takeAwayMethod),o.getProducts()},function(a){o.shopClosed=!0})})}),this.initialize()}return a.prototype.initialize=function(){this.cssService.full(),this.sdkService.call("event",["ft-widget-navigated",{productType:"takeaway",widgetUid:this.sdkService.getWidgetId(),page:"takeAway"}],!0),this.culture=this.$stateParams.culture,this.uid=this.$stateParams.uid},a.prototype.hasProductGroups=function(){return this.products.some(function(a){return null!=a.productGroup})},a.prototype.doesPickUp=function(){return this.takeAwayService.takeAwaySettings.days.filter(function(a){return 1==a.pickUpEnabled}).length>0},a.prototype.getStartTime=function(){var a=this.takeAwayService.getTakeAwayDaySettings(this.cart.preferredDate);return a?"pick-up"==this.cart.takeAwayMethod?a.pickUpStartTime:a.deliveryStartTime:0},a.prototype.getMaxOrderTime=function(){var a=this.takeAwayService.getTakeAwayDaySettings(this.cart.preferredDate);return a&&a.maxDeliveryOrderTime&&"delivery"==this.cart.takeAwayMethod?a.maxDeliveryOrderTime:a&&a.maxPickUpOrderTime&&"pick-up"==this.cart.takeAwayMethod?a.maxPickUpOrderTime:0},a.prototype.getEndTime=function(){var a=this.takeAwayService.getTakeAwayDaySettings(this.cart.preferredDate);return a?"pick-up"==this.cart.takeAwayMethod?a.pickUpEndTime:a.deliveryEndTime:0},a.prototype.doesDelivery=function(){return this.takeAwayService.takeAwaySettings.days.filter(function(a){return 1==a.deliveryEnabled}).length>0},a.prototype.readmore=function(a){this.opened==a?this.opened="":this.opened=a},a.prototype.getProducts=function(){var a=this;this.apiService.getProducts(this.widgetService.restaurant.uid,this.$stateParams.culture,"TAKEAWAY",this.cart.preferredDate).then(function(b){a.products=b.data,a.products.forEach(function(b){var c=a.cart.getProduct(b.uid);c&&(c.quantity<=b.availability||null==b.availability)?(b.quantity=c.quantity,c.availability=b.availability):(b.quantity=0,c&&(c.quantity=0))})})},a.prototype.changeQuantity=function(a,b){a.quantity=Math.max(0,a.quantity+b),this.cart.updateProduct(a),b>0&&this.registerAddToCartEvent()},a.prototype.registerAddToCartEvent=function(){var a={productType:"takeaway",widgetUid:this.sdkService.getWidgetId(),page:"takeaway-addtocart",products:[]};this.cart.products.length&&(this.cart.products.forEach(function(b){a.products.push({type:"takeaway",title:b.title,uid:b.uid,amount:b.price*b.quantity/100,quantity:b.quantity})}),"delivery"==this.cart.takeAwayMethod&&a.products.push({type:"takeaway",title:"Delivery",uid:"NA",amount:this.cart.getTotalAmount()-this.cart.getTotalWithoutDelivery()})),this.sdkService.call("event",["ft-widget-navigated",a],!0)},a.prototype.closeWidget=function(){var a=this;this.cssService.close(),this.$timeout(function(){a.widgetService.home()},500)},a.prototype.checkout=function(){var a=this;this.takeAwayService.updateTimes(this.cart.preferredDate,this.cart.takeAwayMethod).then(function(b){a.$state.go("takeAwayCheckout",{uid:a.$stateParams.uid,culture:a.$stateParams.culture})})},a.$inject=["$scope","$http","$state","$stateParams","$location","$timeout","$route","$localStorage","widgetService","apiService","cssService","sdkService","cartService","takeAwayService"],a}();a.TakeAwayController=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").controller("takeAwayController",FT.Widget.Side.TakeAwayController);var FT;!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m){this.signalRService=a,this.$scope=b,this.$http=c,this.$state=d,this.$stateParams=e,this.$location=f,this.$timeout=g,this.$route=h,this.$localStorage=i,this.widgetService=j,this.apiService=k,this.cssService=l,this.sdkService=m,this.purchaseEventThrown=!1,this.initialize()}return a.prototype.initialize=function(){var a=this;this.cssService.full(),this.checking=!0,this.culture=this.$stateParams.culture,this.uid=this.$stateParams.uid,this.type=this.$stateParams.type,this.orderUid=this.$state.params.order||this.$state.params["ft-order"],this.paymentRequired="true"==this.$stateParams.paymentRequired,this.signalRService.subscribe("order_"+this.orderUid),this.signalRService.addListener("paymentRedirect","takeAwayFinishController",function(a){window.top.location.href=a}),this.$scope.$on("$destroy",function(){a.signalRService.unSubscribe("order_"+a.uid)}),this.$timeout(function(){a.loadOrder(a.orderUid),a.checking&&(a.loadOrder(a.orderUid),a.paymentRequired&&a.redirectToPayment())},3e3)},a.prototype.redirectToPayment=function(){var a=this;this.apiService.getPaymentUrlForOrder(this.orderUid).then(function(b){b.data?(a.paymentUrl=b.data,window.top.location.href=a.paymentUrl):a.$timeout(function(){a.redirectToPayment()},5e3)})},a.prototype.goToPayment=function(){window.top.location.href=this.paymentUrl},a.prototype.isToday=function(a){return moment(a).isSame(new Date,"day")},a.prototype.loadOrder=function(a){var b=this;this.apiService.getOrder(this.widgetService.restaurant,a).then(function(a){if(b.order=a.data,b.checking=!1,$(".ticket-screen").addClass("finished"),"CREATED"===b.order.status)return b.signalRService.addListener("updateOrder","takeAwayFinishController",function(a){b.order.uid===a&&b.loadOrder(b.order.uid)}),!1;"ORDERED"!==b.order.status||b.purchaseEventThrown||b.registerPurchaseEvent()})},a.prototype.registerPurchaseEvent=function(){this.sdkService.call("event",["ft-widget-ordered",{productType:"takeaway",widgetUid:this.sdkService.getWidgetId(),order:{uid:this.order.uid,totalAmount:this.order.totalAmount/100,products:this.order.products.map(function(a){return{type:"takeAway",uid:a.productId,title:a.description,quantity:a.quantity,amount:a.singlePrice/100}})}}],!0),this.purchaseEventThrown=!0,this.sdkService.call("event",["ft-widget-navigated",{productType:"takeaway",widgetUid:this.sdkService.getWidgetId(),page:"finish",products:this.order.products&&this.order.products.map(function(a){return{type:"takeAway",uid:a.productId,title:a.description,quantity:a.quantity,amount:a.singlePrice/100}})}],!0)},a.prototype.close=function(){var a=this;this.cssService.close(),this.$timeout(function(){a.widgetService.home()},500)},a.$inject=["signalRService","$scope","$http","$state","$stateParams","$location","$timeout","$route","$localStorage","widgetService","apiService","cssService","sdkService"],a}();a.TakeAwayFinishController=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").controller("takeAwayFinishController",FT.Widget.Side.TakeAwayFinishController);var FT;!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l){this.webUrl=a,this.$scope=b,this.$http=c,this.$state=d,this.$stateParams=e,this.$location=f,this.$timeout=g,this.$route=h,this.$localStorage=i,this.widgetService=j,this.cssService=k,this.sdkService=l,this.initialize()}return a.prototype.initialize=function(){this.cssService.full(),this.sdkService.call("event",["ft-widget-navigated",{widgetUid:this.sdkService.getWidgetId(),page:"terms"}],!0),this.culture="nl"===this.$stateParams.culture?"nl":"en",this.uid=this.$stateParams.uid},a.$inject=["webUrl","$scope","$http","$state","$stateParams","$location","$timeout","$route","$localStorage","widgetService","cssService","sdkService"],a}();a.TermsController=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").controller("termsController",FT.Widget.Side.TermsController);var FT;!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=this;this.$translate=a,this.$scope=b,this.$http=c,this.$state=d,this.$stateParams=e,this.$location=f,this.$timeout=g,this.$route=h,this.$localStorage=i,this.widgetService=j,this.apiService=k,this.timeSpanService=l,this.cssService=m,this.sdkService=n,this.weekDays=[moment.weekdaysShort(1),moment.weekdaysShort(2),moment.weekdaysShort(3),moment.weekdaysShort(4),moment.weekdaysShort(5),moment.weekdaysShort(6),moment.weekdaysShort(0)],this.showCalendar=!1,this.showPeople=!1,this.showTimes=!1,this.noAvailability=!1,this.widgetService.restaurantLoaded().then(function(a){o.restaurant=a,o.initialize()})}return a.prototype.initialize=function(){this.cssService.small(),this.culture=this.$stateParams.culture,this.uid=this.$stateParams.uid,this.ticketId=this.$stateParams.ticketId,this.currentBooking=this.widgetService.booking,this.getTicket()},a.prototype.clearMessage=function(){this.message=""},a.prototype.getTicket=function(){var a=this;this.apiService.getProduct(this.widgetService.restaurant.uid,this.ticketId,this.culture,this.widgetService.friendCode).then(function(b){a.ticket=b.data,a.sdkService.call("event",["ft-widget-navigated",{productType:"ticket",widgetUid:a.sdkService.getWidgetId(),page:"ticket/"+a.ticket.uid,from:a.$stateParams.from,products:[{type:"ticket",title:a.ticket.title,uid:a.ticket.uid,amount:a.ticket.price/100,quantity:a.currentBooking.numberOfPeople}]}],!0),a.widgetService.voucher&&a.widgetService.voucher.ticket&&a.widgetService.voucher.ticket.uid===a.ticket.uid?a.currentBooking.numberOfPeople=a.widgetService.voucher.quantity:a.currentBooking.numberOfPeople=a.widgetService.searchParams.numberOfPeople,a.ticket.minPartySize>a.currentBooking.numberOfPeople&&(a.currentBooking.numberOfPeople=a.ticket.minPartySize,!a.widgetService.ticketOnly&&a.$stateParams.from&&(a.message="We've changed the reservation details to match the availability of this ticket.")),a.ticket.maxPartySize<a.currentBooking.numberOfPeople&&(a.currentBooking.numberOfPeople=a.ticket.maxPartySize,!a.widgetService.ticketOnly&&a.$stateParams.from&&(a.message="We've changed the reservation details to match the availability of this ticket.")),a.currentBooking.bookingDate=a.widgetService.searchParams.bookingDate,a.currentBooking.bookingTime=a.widgetService.searchParams.bookingTime,a.apiService.getFirstDateTime(a.widgetService.restaurant,a.widgetService.dateFromBooking(a.currentBooking),a.culture,a.currentBooking.numberOfPeople,a.ticketId,a.widgetService.friendCode,a.widgetService.voucher?a.widgetService.voucher.code:"").then(function(b){var c=b.data;moment(c.time).format("YYYY-MM-DD")==moment(a.widgetService.searchParams.bookingDate).format("YYYY-MM-DD")&&c.timeString==a.widgetService.searchParams.bookingTime||a.widgetService.ticketOnly||!a.$stateParams.from||(a.message="We've changed the reservation details to match the availability of this ticket."),a.widgetService.setBookingTimes(c,!0),a.apiService.getTimesForDay(a.widgetService.restaurant,new Date(a.widgetService.dateFromBooking(a.currentBooking)),a.currentBooking.numberOfPeople,a.culture,a.ticket.uid,a.widgetService.friendCode,a.widgetService.voucher?a.widgetService.voucher.code:"").then(function(b){a.ticketTimes=b.data});a.$scope.$watch(function(){return a.currentBooking.bookingDate},function(b,c){c!==b&&a.apiService.getTimesForDay(a.widgetService.restaurant,new Date(a.widgetService.dateFromBooking(a.currentBooking)),a.currentBooking.numberOfPeople,a.culture,a.ticket.uid,a.widgetService.friendCode,a.widgetService.voucher?a.widgetService.voucher.code:"").then(function(b){a.ticketTimes=b.data;var c=a.ticketTimes.filter(function(a){return"UNAVAILABLE"!=a.status});if(c.length){a.noAvailability=!1;var d=c.filter(function(b){return moment(b.time).format("HH:mm")==a.currentBooking.bookingTime});d.length>0?a.widgetService.setBookingTimes(d[0],!1):a.widgetService.setBookingTimes(c[0],!1)}else a.noAvailability=!0})},!1),a.$scope.$watch(function(){return a.currentBooking.numberOfPeople},function(b,c){c!==b&&a.apiService.getFirstDateTime(a.widgetService.restaurant,a.widgetService.dateFromBooking(a.currentBooking),a.currentBooking.culture,a.currentBooking.numberOfPeople,a.ticket.uid,a.widgetService.friendCode,a.widgetService.voucher?a.widgetService.voucher.code:"").then(function(b){var c=b.data;a.widgetService.setBookingTimes(c,!0)})},!1)},function(b){a.noAvailability=!0})})},a.prototype.close=function(){var a=this;this.cssService.close(),this.$timeout(function(){a.widgetService.home()},500)},a.prototype.openSelect=function(a){var b=this;a="show"+a,this[a]?this[a]=!1:(this.showCalendar=!1,this.showPeople=!1,this.showTimes=!1,this[a]=!0,$(".widget-container").on("click."+a,function(c){b[a]=!1,b.$scope.$apply(),$(".widget-container").off("click."+a)}))},a.prototype.continue=function(){if(!this.showPeople&&!this.showCalendar&&!this.showTimes){if(!this.currentBooking.bookingTime||!this.currentBooking.bookingDate)return this.$state.go("error",{uid:this.uid,culture:this.culture,errorMessage:this.$translate.getTranslation("No correct booking date or time selected."),errorCode:400}),!1;this.widgetService.selectedTicket=this.ticket,this.$state.go("checkout",{uid:this.uid,culture:this.culture})}},a.prototype.getTillTime=function(a){return moment(a.time).add(a.maxDuration,"minutes").format("LT")},a.prototype.setPeople=function(a){this.currentBooking.numberOfPeople=a,this.widgetService.searchParams.numberOfPeople=a,this.showPeople=!1},a.prototype.setTime=function(a){this.widgetService.setBookingTimes(a,!1),this.showTimes=!1},a.prototype.windowDisplayLimits=function(a){return!!a&&(!("y"==a[1]&&parseInt(a[0])>=1)&&(!("M"==a[1]&&parseInt(a[0])>12)&&(!("w"==a[1]&&parseInt(a[0])>52)&&(("m"!=a[1]||0!=parseInt(a[0]))&&!("d"==a[1]&&parseInt(a[0])>365)))))},a.prototype.bookingWindowString=function(a,b){var c=this.windowDisplayLimits(a),d=this.windowDisplayLimits(b);return c||d?c&&d?this.$translate.getTranslation("Bookable from {0} up to {1} in advance",this.timeSpanService.toString(b),this.timeSpanService.toString(a)):c?this.$translate.getTranslation("Bookable up to {0} in advance",this.timeSpanService.toString(a)):d?this.$translate.getTranslation("Bookable {0} in advance",this.timeSpanService.toString(b)):void 0:""},a.$inject=["$translate","$scope","$http","$state","$stateParams","$location","$timeout","$route","$localStorage","widgetService","apiService","timeSpanService","cssService","sdkService"],a}();a.TicketController=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").controller("ticketController",FT.Widget.Side.TicketController);var FT;!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d,e,f,g,h){var i=this;this.$scope=a,this.$timeout=b,this.widgetService=c,this.$stateParams=d,this.$state=e,this.takeAwayService=f,this.cssService=g,this.sdkService=h,this.$scope.$on("searchReady",function(){i.ready=!0}),this.$timeout(function(){i.ready=!0},3e3)}return a.prototype.open=function(a){$("body").hasClass("ft-open")&&this.$state.current.name===a?this.cssService.close("toolbar"):($("body").hasClass("ft-open")||this.cssService.open("toolbar"),this.$state.go(a,{uid:this.$stateParams.uid,culture:this.$stateParams.culture}))},a.$inject=["$scope","$timeout","widgetService","$stateParams","$state","takeAwayService","cssService","sdkService"],a}();a.ToolbarController=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").controller("toolbarController",FT.Widget.Side.ToolbarController);var FT;!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d,e,f){this.$state=a,this.$stateParams=b,this.$timeout=c,this.widgetService=d,this.apiService=e,this.cssService=f,this.initialize()}return a.prototype.initialize=function(){var a=this;this.culture=this.$stateParams.culture,this.uid=this.$stateParams.uid,this.recipientId=this.$stateParams.rid,this.email=this.$state.params.email||this.$state.params["ft-unsubscribe"],this.email&&(this.email=this.email.replace(/ /g,"+")),this.code=this.$state.params.code||this.$state.params["ft-code"],this.recipientId=this.$state.params.recipientId||this.$state.params["ft-rid"],this.$timeout(function(){a.unsubscribe()},1500)},a.prototype.unsubscribe=function(){var a=this;this.apiService.unsubscribe(this.email,this.uid,this.code,this.culture,this.recipientId).then(function(b){b.data?a.unsubscribed=!0:a.failed=!0})},a.prototype.close=function(){var a=this;this.cssService.close(),this.$timeout(function(){a.widgetService.home()},500)},a.$inject=["$state","$stateParams","$timeout","widgetService","apiService","cssService"],a}();a.UnsubscribeController=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").controller("unsubscribeController",FT.Widget.Side.UnsubscribeController);var FT;!function(a){!function(b){!function(b){var c=function(){function c(a,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s=this;this.product=a,this.$filter=c,this.$scope=d,this.$rootScope=e,this.$http=f,this.$state=g,this.$stateParams=h,this.$location=i,this.$timeout=j,this.$route=k,this.$localStorage=l,this.widgetService=m,this.apiService=n,this.timeSpanService=o,this.cssService=p,this.checkoutService=q,this.sdkService=r,this.orderInfo=new b.OrderInfo,this.voucherInfo=new b.VoucherInfo,this.quantity=1,this.minQuantity=1,this.maxQuantity=null,this.terms=!1,this.sendLater=!1,this.submitting=!1,this.btnDisable=!1,this.sendAtDate=o.dateFromNow(0,0,1),this.sendAtTime="12:00",this.sendAtStartTimeOptions="00:00",this.today=moment(new Date).add(-1,"days").toDate(),this.$scope.$watch(function(){return s.sendAtDate.toString()+s.sendAtTime},function(a,b){a!==b&&s.setSendAt()}),this.widgetService.restaurantLoaded().then(function(a){s.restaurant=a,s.initialize()})}return c.prototype.initialize=function(){this.cssService.full();var b={widgetUid:this.sdkService.getWidgetId(),productType:"voucher",page:"checkout"};this.product&&(b.products=[{type:"voucher",title:this.product.title,uid:this.product.uid,amount:this.product.price/100,quantity:this.quantity}]),this.sdkService.call("event",["ft-widget-navigated",b],!0),this.culture=this.$stateParams.culture,this.uid=this.$stateParams.uid,this.$localStorage.title&&(this.orderInfo.title=this.$localStorage.title),this.orderInfo.company="true"===this.$localStorage.company,this.orderInfo.companyName=this.$localStorage.companyName,this.orderInfo.firstName=this.$localStorage.firstName,this.orderInfo.lastName=this.$localStorage.lastName,this.orderInfo.email=this.$localStorage.email,this.orderInfo.telephone=this.$localStorage.telephone,this.orderInfo.culture=this.culture,this.expirationDate=this.timeSpanService.dateFromNow(this.widgetService.voucherService.voucherSettings.expirationTime),a.Helpers.StorageHelper.storageAvailable("sessionStorage")&&sessionStorage.setItem("product",JSON.stringify(this.product)),this.product.ticket&&(this.minQuantity=this.product.ticket.minPartySize>0?this.product.ticket.minPartySize:this.widgetService.restaurant.minPartySize,this.maxQuantity=this.product.ticket.maxPartySize>0?this.product.ticket.maxPartySize:this.widgetService.restaurant.maxPartySize,this.quantity=this.minQuantity<=2?2:this.minQuantity),this.getTotalAmount()>0&&this.getPaymentMethods(),this.voucherInfo.culture=this.$stateParams.culture},c.prototype.changeQuantity=function(a){this.quantity+a<=this.maxQuantity&&this.quantity+a>=this.minQuantity&&(this.quantity=this.quantity+a)},c.prototype.sendToFriendChanged=function(){this.voucherInfo.sendToFriend||(this.voucherInfo.sendAt=null,this.sendLater=!1)},c.prototype.setSendAt=function(){moment(this.sendAtDate).isSame(new Date,"day")?(this.sendAtStartTimeOptions=this.getNextQuarter(),this.dateFromTime(this.sendAtTime,new Date)<(new Date).getTime()&&(this.sendAtTime=this.sendAtStartTimeOptions)):this.sendAtStartTimeOptions="00:00";var a=this.sendAtTime.split(":");this.voucherInfo.sendAt=new Date(this.sendAtDate.setHours(parseInt(a[0]),parseInt(a[1])))},c.prototype.toggleSendAt=function(){this.sendLater=!this.sendLater,this.sendLater?this.setSendAt():this.voucherInfo.sendAt=null},c.prototype.getNextQuarter=function(){var a=(new Date).getMinutes()%15;return moment().add(15-a,"minutes").format("HH:mm")},c.prototype.getIdealIssuers=function(){var a=this;this.apiService.getIdealIssuers(this.widgetService.restaurant).then(function(b){a.issuers=b.data})},c.prototype.getPaymentMethods=function(){var a=this;this.apiService.getPaymentMethods(this.widgetService.restaurant,this.getProductAmount(),"GIFTVOUCHER").then(function(b){a.paymentMethods=b.data,1===a.paymentMethods.length&&a.selectMethod(a.paymentMethods[0])})},c.prototype.getProductAmount=function(){return this.product?this.product.price*this.quantity:0},c.prototype.getTotalAmount=function(){if(!this.product)return 0;var a=0;return a=this.product.price*this.quantity,this.paymentMethod&&(a+=this.paymentMethod.paymentFee),a},c.prototype.selectMethod=function(a){this.paymentMethod=a,"ideal"!==a.id||this.issuers||this.getIdealIssuers()},c.prototype.checkout=function(){this.submitting=!0,this.btnDisable=!0,this.$scope.checkout.$valid?this.checkoutService.createProductOrder(this.orderInfo,this.product.uid,this.quantity,this.paymentMethod,this.issuer,this.voucherInfo):this.btnDisable=!1},c.prototype.dateFromTime=function(a,b){var c=a.split(":");return b.setHours(parseInt(c[0]),parseInt(c[1]),0,0)},c.$inject=["product","$filter","$scope","$rootScope","$http","$state","$stateParams","$location","$timeout","$route","$localStorage","widgetService","apiService","timeSpanService","cssService","checkoutService","sdkService"],c}();b.VoucherCheckoutController=c}(b.Side||(b.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").controller("voucherCheckoutController",FT.Widget.Side.VoucherCheckoutController);var FT;!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m){this.signalRService=a,this.$scope=b,this.$http=c,this.$state=d,this.$stateParams=e,this.$location=f,this.$timeout=g,this.$route=h,this.$localStorage=i,this.widgetService=j,this.apiService=k,this.cssService=l,this.sdkService=m,this.initialize()}return a.prototype.initialize=function(){var a=this;this.cssService.full(),this.checking=!0,this.culture=this.$stateParams.culture,this.uid=this.$stateParams.uid,this.type=this.$stateParams.type,this.orderUid=this.$state.params.order||this.$state.params["ft-order"],this.paymentRequired="true"==this.$stateParams.paymentRequired,this.signalRService.subscribe("order_"+this.orderUid),this.signalRService.addListener("paymentRedirect","shopFinishController",function(a){window.top.location.href=a}),this.$scope.$on("$destroy",function(){a.signalRService.unSubscribe("order_"+a.uid)}),this.$timeout(function(){a.checking&&(a.loadOrder(a.orderUid),a.paymentRequired&&a.redirectToPayment())},3e3)},a.prototype.redirectToPayment=function(){var a=this;this.apiService.getPaymentUrlForOrder(this.orderUid).then(function(b){b.data?(a.paymentUrl=b.data,window.top.location.href=a.paymentUrl):a.$timeout(function(){a.redirectToPayment()},5e3)})},a.prototype.goToPayment=function(){window.top.location.href=this.paymentUrl},a.prototype.loadOrder=function(a){var b=this;this.apiService.getOrder(this.widgetService.restaurant,a).then(function(c){b.order=c.data,b.sdkService.call("event",["ft-widget-navigated",{productType:"voucher",widgetUid:b.sdkService.getWidgetId(),page:"finish",products:b.order.products.map(function(a){return{type:"voucher",uid:a.productId,title:a.description,quantity:a.quantity,amount:a.singlePrice/100}})}],!0),b.apiService.getVoucherInfoForOrder(b.widgetService.restaurant,a).then(function(a){if(b.voucherInfo=a.data,b.checking=!1,$(".ticket-screen").addClass("finished"),"CREATED"===b.order.status)return b.signalRService.addListener("updateOrder","voucherFinishController",function(a){b.order.uid===a&&(b.loadOrder(b.order.uid),b.registerPurchaseEvent())}),!1;b.registerPurchaseEvent()})})},a.prototype.registerPurchaseEvent=function(){"ORDERED"===this.order.status&&this.sdkService.call("event",["ft-widget-ordered",{productType:"voucher",
widgetUid:this.sdkService.getWidgetId(),order:{uid:this.order.uid,totalAmount:this.order.totalAmount/100,products:this.order.products.map(function(a){return{type:"voucher",uid:a.productId,title:a.description,quantity:a.quantity,amount:a.singlePrice/100}})}}],!0)},a.prototype.close=function(){var a=this;this.cssService.close(),this.$timeout(function(){a.widgetService.home()},500)},a.$inject=["signalRService","$scope","$http","$state","$stateParams","$location","$timeout","$route","$localStorage","widgetService","apiService","cssService","sdkService"],a}();a.VoucherFinishController=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").controller("voucherFinishController",FT.Widget.Side.VoucherFinishController);var FT;!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=this;this.$scope=a,this.$http=b,this.$state=c,this.$stateParams=d,this.$location=e,this.$timeout=f,this.$route=g,this.$localStorage=h,this.widgetService=i,this.apiService=j,this.cssService=k,this.sdkService=l,this.voucherService=m,this.orderBy=function(a){return a.ticket?1e4*-a.price:-a.price},this.widgetService.restaurantLoaded().then(function(a){n.restaurant=a,n.initialize()})}return a.prototype.readmore=function(a){this.opened==a?this.opened="":this.opened=a},a.prototype.getProducts=function(a){var b=this;this.apiService.getProducts(a,this.$stateParams.culture,"GIFTVOUCHER").then(function(a){b.products=a.data})},a.prototype.initialize=function(){this.cssService.full(),this.sdkService.call("event",["ft-widget-navigated",{productType:"voucher",widgetUid:this.sdkService.getWidgetId(),page:"voucher"}],!0),this.culture=this.$stateParams.culture,this.uid=this.$stateParams.uid,this.getProducts(this.restaurant.uid)},a.prototype.selectProduct=function(a){this.$state.go("voucherCheckout",{uid:this.$stateParams.uid,culture:this.$stateParams.culture,productUid:a.uid})},a.prototype.closeWidget=function(){var a=this;this.cssService.close(),this.$timeout(function(){a.widgetService.home()},500)},a.$inject=["$scope","$http","$state","$stateParams","$location","$timeout","$route","$localStorage","widgetService","apiService","cssService","sdkService","voucherService"],a}();a.VouchersController=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").controller("vouchersController",FT.Widget.Side.VouchersController);var FT;!function(a){!function(b){!function(b){!function(c){var d=function(){function c(a,b,c,d,e,f,g,h){var i=this;this.$scope=a,this.$element=b,this.$timeout=c,this.$stateParams=d,this.$location=e,this.$animate=f,this.apiService=g,this.widgetService=h,this.weekDays=[moment.weekdaysShort(1),moment.weekdaysShort(2),moment.weekdaysShort(3),moment.weekdaysShort(4),moment.weekdaysShort(5),moment.weekdaysShort(6),moment.weekdaysShort(0)],this.prevDisabled=!0,this.nextDisabled=!1,this.touchDaySelected=null,this.tooltip={active:!1,title:"",message:"",selectable:!1,day:null},this.loading=!1,this.booking=this.widgetService.booking,this.$scope.$watch(function(){return i.active},function(a){a||i.hideTooltip()})}return c.prototype.select=function(a){this.selected=a.date,this.active=!1,this.hideTooltip()},c.prototype.openDay=function(a,b){a.message?this.showTooltip(a):0==a.status&&this.select(a)},c.prototype.isSelected=function(a){return moment(this.selected).isSame(a.date,"day")},c.prototype.isToday=function(a){return moment().isSame(a.date,"day")},c.prototype.load=function(){var a=this;this.widgetService.restaurantLoaded().then(function(b){a.loadMonth(a.selected.getMonth()+1,a.selected.getFullYear())})},c.prototype.prevMonth=function(){var a=moment([this.month.fullYear,this.month.monthNumber-1,1]);a.add(-1,"month"),this.loadMonth(a.month()+1,a.year()),this.hideTooltip()},c.prototype.nextMonth=function(){var a=moment([this.month.fullYear,this.month.monthNumber-1,1]);a.add(1,"month"),this.loadMonth(a.month()+1,a.year()),this.hideTooltip()},c.prototype.loadMonth=function(c,d){var e=this;this.loading=!0;var h="search"==this.type?this.widgetService.searchParams.numberOfPeople:this.booking.numberOfPeople;this.apiService.getAvailabilityMonthWeeks(this.widgetService.restaurant,c,d,h,this.$stateParams.culture,this.ticket,this.widgetService.friendCode,this.widgetService.voucher?this.widgetService.voucher.code:"").then(function(h){var i=[];i=a.Helpers.DateHelper.getWeekDaysForMonth(c,d).map(function(a){var c,d=h.data.filter(function(b){return b.day==a.getDate()&&b.month===a.getMonth()+1})[0];return d?c=d:(c=new b.BookingDate,c.day=a.getDate(),c.date=a,c.month=a.getMonth()+1,c.status=1,c.dayOfWeek=a.getDay()-1,c.week=moment(a).week()),c});var j=new f;j.shortName=moment(new Date(d,c-1)).format("MMM"),j.monthName=moment(new Date(d,c-1)).format("MMMM"),j.monthNumber=c,j.fullYear=d,j.color=e.getColorFromString((j.monthNumber+j.fullYear).toString());for(var k=new g,l=0;l<i.length;l++){var m=i[l],n=m.backgroundColor,o=i[l-1]?i[l-1].backgroundColor:null,p=i[l+1]?i[l+1].backgroundColor:null;n&&l>0&&o!=n&&(m.firstDayOfPeriod=!0),n&&i.length>l+1&&p!=n&&(m.lastDayOfPeriod=!0),m.otherMonth=m.month!==c,0===m.dayOfWeek&&k.days.length>0&&(j.weeks.push(k),k=new g),k.days.push(m)}j.weeks.push(k),e.month=j,e.prevDisabled=moment().month()+1===c&&moment().year()===d,e.loading=!1})},c.prototype.getColorFromString=function(a){if(null!=a){return(new ColorHash).hex(a)}return"transparent"},c.prototype.showTooltip=function(a){this.tooltip.title="en"==this.$stateParams.culture?moment(a.date).format("MMMM D, YYYY"):moment(a.date).format("D MMMM YYYY"),this.tooltip.message=a.message,this.tooltip.selectable=0==a.status,this.tooltip.day=a,this.tooltip.active=!0},c.prototype.hideTooltip=function(){this.tooltip.active=!1},c.$inject=["$scope","$element","$timeout","$stateParams","$location","$animate","apiService","widgetService"],c}();c.CalendarDirectiveController=d;var e=function(){function a(){this.restrict="E",this.templateUrl="/app/widgets/side/directives/calendar.html",this.scope={selected:"=",active:"=",ticket:"=",ondateselect:"&",type:"@"},this.replace=!0,this.controllerAs="ctrl",this.controller=d,this.bindToController=!0,this.link=function(a,b,c,d){a.$watch(function(){return d.active},function(a,b){b!==a&&1==a&&d.load()},!1),a.$watch(function(){return d.booking.numberOfPeople+d.widgetService.searchParams.numberOfPeople},function(a,b){b!==a&&(d.month=null)},!1)}}return a}();c.CalendarDirective=e;var f=function(){function a(){this.weeks=[]}return a}();c.Month=f;var g=function(){function a(){this.days=[]}return a}();c.Week=g}(b.Directives||(b.Directives={}))}(b.Side||(b.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").controller("calendarDirectiveController",FT.Widget.Side.Directives.CalendarDirectiveController).directive("calendar",[function(){return new FT.Widget.Side.Directives.CalendarDirective}]);var FT;!function(a){!function(a){!function(a){var b=function(){function a(){this.restrict="A",this.require="?ngModel",this.link=function(a,b,c,d){d.$parsers.push(function(a){return a?new Date(a):null}),d.$formatters.push(function(a){return a})}}return a}();a.ConvertToDateDirective=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").directive("convertToDate",function(){return new FT.Widget.Side.ConvertToDateDirective});var FT;!function(a){!function(a){!function(a){var b=function(){function a(){this.restrict="A",this.require="?ngModel",this.link=function(a,b,c,d){d.$parsers.push(function(a){return parseInt(a,10)}),d.$formatters.push(function(a){return""+a})}}return a}();a.ConvertToNumberDirective=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").directive("convertToNumber",function(){return new FT.Widget.Side.ConvertToNumberDirective});var FT;!function(a){!function(a){!function(a){!function(b){var c=function(){function b(a,b,c,d,e,f){this.$scope=a,this.$element=b,this.$timeout=c,this.$routeParams=d,this.$location=e,this.$animate=f,this.today=new Date((new Date).setHours(0,0,0,0)),this.weekDays=[moment.weekdaysShort(1),moment.weekdaysShort(2),moment.weekdaysShort(3),moment.weekdaysShort(4),moment.weekdaysShort(5),moment.weekdaysShort(6),moment.weekdaysShort(0)],this.$animate.enabled(b,!1),this.weeks=[],this.selectedDate?this.loadMonth(this.selectedDate.getMonth(),this.selectedDate.getFullYear()):this.loadMonth((new Date).getMonth(),(new Date).getFullYear()),this.$scope.$on("$destroy",function(){$(document).off("click.datePicker")})}return b.prototype.openCalendar=function(){var a=this;this.open=!0,$(document).off("click.datePicker"),$(document).on("click.datePicker",function(b){$(b.target).closest(".dp-calendar, .dp-select").length||(a.closeCalendar(),a.$scope.$apply())})},b.prototype.closeCalendar=function(){this.open=!1,$(document).off("click.datePicker")},b.prototype.getMonthDays=function(a){return new Date(2018,a,0).getDate()},b.prototype.select=function(a){this.max&&a.date>this.max||this.min&&a.date<=this.min||(this.selectedDate=new Date(a.date.setHours(0,0,0,0)),this.open=!1)},b.prototype.isSelected=function(a){return moment(this.selectedDate).isSame(a.date,"day")},b.prototype.isToday=function(a){return moment().isSame(a.date,"day")},b.prototype.isSameMonth=function(){return moment().isSame(this.month,"month")},b.prototype.loadMonth=function(a,b){var c=this.getDaysInMonth(a,b);this.month=moment(c[0]).clone().startOf("month"),this.weeks=[],this.buildCalendar(c)},b.prototype.getDaysInMonth=function(a,b){for(var c=new Date(b,a,1),d=[];c.getMonth()===a;)d.push(c),c=new Date(b,a,c.getDate()+1);return d},b.prototype.canMoveNext=function(){return!this.max||moment(this.max).isAfter(this.month,"month")},b.prototype.canMovePrevious=function(){return!this.min||moment(this.min).isBefore(this.month,"month")},b.prototype.next=function(){var a=this.month.month()+1,b=this.month.year();12===a&&(a=0,b+=1),this.loadMonth(a,b)},b.prototype.removeDate=function(){this.selectedDate=null},b.prototype.toggleCalendar=function(){this.open?this.closeCalendar():this.openCalendar(),this.open&&!this.month&&this.loadMonth(this.selectedDate.getMonth(),this.selectedDate.getFullYear())},b.prototype.previous=function(){var a=this.month.month()-1,b=this.month.year();-1===a&&(a=11,b-=1),this.loadMonth(a,b)},b.prototype.buildCalendar=function(b){for(var c=this,d=moment(b[0]).isoWeek(),e=moment(b[0]).isoWeekday()-1,f=b[0].getMonth(),g=[],h=0;h<e;h++){var i=new a.BookingDate;i.status=-1,i.month=f-1,i.day=this.getMonthDays(f-1)-h,i.date=new Date(this.month.year(),this.month.month(),this.month.day()),g.unshift(i)}if(b.forEach(function(b){var e=new a.BookingDate;e.status=c.max&&b>c.max||c.min&&b<=c.min?2:1,e.month=b.getMonth(),e.day=b.getDate(),e.date=b;var f=moment(b).isoWeek();f!==d&&(c.weeks.push(g),d=f,g=[]),g.push(e)}),g.length){for(var j=7-g.length,h=1;h<=j;h++){var i=new a.BookingDate;i.status=-1,i.month=f+1,i.day=h,i.date=new Date(this.month.year(),this.month.month(),this.month.day()),g.push(i)}this.weeks.push(g)}},b.$inject=["$scope","$element","$timeout","$routeParams","$location","$animate"],b}();b.DatePickerDirectiveController=c;var d=function(){function a(){this.restrict="E",this.templateUrl="/app/widgets/side/directives/datePicker.html",this.scope={selectedDate:"=",dateFormat:"@",min:"=",max:"="},this.controllerAs="ctrl",this.controller=c,this.bindToController=!0}return a}();b.DatePickerDirective=d}(a.Directives||(a.Directives={}))}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").controller("datePickerDirectiveController",FT.Widget.Side.Directives.DatePickerDirectiveController).directive("datePicker",[function(){return new FT.Widget.Side.Directives.DatePickerDirective}]);var FT;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a){this.$timeout=a,this.restrict="A",this.link=function(a,b,c,d){b.on("click",function(b){var d=c.exclude,e=c.globalClick;$(document).off("click.global"),$(document).on("click.global",function(c){if(!$(c.target).is(d))return a.$event=b,a.$apply(e),c.preventDefault(),c.stopImmediatePropagation(),!1})}),a.$on("$destroy",function(){$(document).off("click.global")})}}return a}();a.GlobalClickDirective=b}(a.Directives||(a.Directives={}))}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").directive("globalClick",["$timeout",function(a){return new FT.Widget.Side.Directives.GlobalClickDirective(a)}]);var FT;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a,b,c){var d=this;this.$log=a,this.$window=b,this.$parse=c,this.require="ngModel",this.link=function(a,b,c,e){if(c.type&&"text"!==c.type&&"tel"!==c.type||"INPUT"!==b[0].tagName)return void d.$log.warn("ng-intl-tel-input can only be applied to a *text* or *tel* input");window.intlTelInputUtils||d.$log.warn("intlTelInputUtils is not defined. Formatting and validation will not work."),d.intlTelInp=window.intlTelInput(b[0],{initialCountry:"auto",preferredCountries:["nl","be","de","fr","uk","us"],geoIpLookup:function(a){localStorage.getItem("int-tel-country")||$.get("https://ipinfo.io",function(){},"jsonp").always(function(a){var b=a&&a.country?a.country:c.telDefaultCountry||"nl";d.intlTelInp.setCountry(b),localStorage.setItem("int-tel-country",b)})}});var f=localStorage.getItem("int-tel-country");f&&d.intlTelInp.setCountry(f),angular.element(d.$window).on("countrychange",function(){var a=d.intlTelInp.getNumber();e.$setViewValue(a)}),e.$validators.ngIntlTelInput=function(a){return!(a||b[0].value.length>0)||d.intlTelInp.isValidNumber()},e.$parsers.push(function(a){return d.intlTelInp.selectedCountryData&&d.intlTelInp.selectedCountryData.iso2&&localStorage.setItem("int-tel-country",d.intlTelInp.selectedCountryData.iso2),d.intlTelInp.getNumber()}),e.$formatters.push(function(a){return a&&(d.intlTelInp.selectedCountryData&&d.intlTelInp.selectedCountryData.iso2&&localStorage.setItem("int-tel-country",d.intlTelInp.selectedCountryData.iso2),d.intlTelInp.setNumber(a),"+"!==a.charAt(0)&&e.$setViewValue(a)),a})}}return a}();a.IntTelDirective=b}(a.Directives||(a.Directives={}))}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").directive("intTel",["$log","$window","$parse",function(a,b,c,d){return new FT.Widget.Side.Directives.IntTelDirective(b,c,d)}]);var FT;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d,e,f,g){this.$scope=a,this.$element=b,this.$timeout=c,this.$routeParams=d,this.$location=e,this.$animate=f,this.$translate=g}return a.prototype.init=function(a){this.content&&(0===this.content.length&&a.css("height","0px"),this.content=this.content,this.hasLimit=this.content.length>this.limit,this.open=!1,this.currentLimit=this.limit,this.readMoreText=this.$translate.getTranslation("read more"))},a.prototype.getContent=function(){return this.content?this.content.replace("&nbsp;",""):null},a.prototype.readMore=function(){this.open?(this.currentLimit=this.limit,this.open=!1,this.readMoreText=this.$translate.getTranslation("read more")):(this.currentLimit=1e8,this.open=!0,this.readMoreText=this.$translate.getTranslation("read less"))},a.$inject=["$scope","$element","$timeout","$routeParams","$location","$animate","$translate"],a}();a.ReadMoreDirectiveController=b;var c=function(){function a(){this.restrict="EA",this.template='<span ng-click="ctrl.readMore()" ng-class="{limited : ctrl.hasLimit}" ng-bind-html="ctrl.getContent() | limitTo: ctrl.currentLimit"></span><span ng-click="ctrl.readMore()" class="expand-icon" ng-if="ctrl.hasLimit && !ctrl.open">... <svg class="more-icon" width="14" height="14"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#down"></use></svg></span>',this.scope={limit:"<",content:"<"},this.controllerAs="ctrl",this.controller=b,this.bindToController=!0,this.link=function(a,b,c,d){d.init(b)}}return a}();a.ReadMoreDirective=c}(a.Directives||(a.Directives={}))}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").controller("readMoreDirectiveController",FT.Widget.Side.Directives.ReadMoreDirectiveController).directive("readMore",[function(){return new FT.Widget.Side.Directives.ReadMoreDirective}]);var FT;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a){this.$timeout=a,this.scope={stopEvent:"=?"},this.restrict="A",this.link=function(a,b,c,d){a.stopEvent?b.on("click."+a.stopEvent+" mousedown."+a.stopEvent+" mouseup."+a.stopEvent,function(a){a.stopImmediatePropagation()}):b.on("click mousedown mouseup",function(a){a.stopImmediatePropagation()})}}return a}();a.StopEventDirective=b}(a.Directives||(a.Directives={}))}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").directive("stopEvent",["$timeout",function(a){return new FT.Widget.Side.Directives.StopEventDirective(a)}]);var FT;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a){var b=this;this.$timeout=a,this.restrict="A",this.link=function(a,c,d,e){c[0].addEventListener("wheel",function(a){var b=c[0],d=Math.round(b.scrollTop),e=Math.round(b.scrollHeight-b.offsetHeight),f=a.deltaY;(d>=e&&f>0||0===d&&f<0)&&a.preventDefault()}),c[0].addEventListener("touchstart",function(a){b.previousClientY=a.touches[0].clientY}),c[0].addEventListener("touchmove",function(a){var d=c[0],e=Math.round(d.scrollTop),f=Math.round(d.scrollHeight-d.offsetHeight),g=a.touches[0].clientY,h=b.previousClientY-g;(e>=f&&h>0||0===e&&h<0)&&a.preventDefault(),b.previousClientY=g})}}return a}();a.StopParentScroll=b}(a.Directives||(a.Directives={}))}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").directive("stopParentScroll",["$timeout",function(a){return new FT.Widget.Side.Directives.StopParentScroll(a)}]);var FT;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a){var b=this;this.$timeout=a,this.restrict="EA",this.require="?ngModel",this.scope={start:"@",end:"@",format:"<"},this.template='<option ng-repeat="time in timesArray track by $index" value="{{time.value}}">{{time.text}}</option>',this.replace=!1,this.link=function(a,c,d,e){a.$watch(function(){return a.start+a.end},function(f,g){b.renderOptions(a,c,d,e)})}}return a.prototype.renderOptions=function(a,b,c,d){for(var e=new Array,f=b,g=new Date(0,0,0,parseInt(a.start.split(":")[0]),parseInt(a.start.split(":")[1])),h=this.minutesFromTime(moment(g).format("HH:mm")),i=new Date(0,0,parseInt(a.end.split(":")[0])<7?1:0,parseInt(a.end.split(":")[0]),parseInt(a.end.split(":")[1]));g<=i;){var j=moment(g).format("HH:mm"),k={text:"",value:""};k.text=moment(g).format(12==a.format?"LT":"HH:mm"),k.value="minutes"==c.unit?h:j,e.push(k),g.setMinutes(g.getMinutes()+parseInt(c.interval)),h+=parseInt(c.interval)}a.timesArray=e,this.$timeout(function(){d&&(d.$render=function(){f.val(d.$viewValue),null==f.val()&&f.val(f.find("option").first().val())},f.on("change",function(){d.$setViewValue(this.value)})),d.$render()})},a.prototype.minutesFromTime=function(a){var b=a.split(":");return 60*parseInt(b[0])+parseInt(b[1])},a.factory=function(){var b=function(b){return new a(b)};return b.$inject=["$timeout"],b},a}();a.TimePickerDirective=b}(a.Directives||(a.Directives={}))}(a.Side||(a.Side={}))}(a.Widgets||(a.Widgets={}))}(FT||(FT={})),angular.module("widgetSide").directive("timepicker",FT.Widgets.Side.Directives.TimePickerDirective.factory());var FT;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d,e,f,g){var h=this;this.$scope=a,this.$element=b,this.$timeout=c,this.$routeParams=d,this.$location=e,this.$animate=f,this.$translate=g,this.$scope.$watch(function(){return h.to},function(a,b){a!==b&&h.setupTimer()})}return a.prototype.setupTimer=function(){var a=this;this.to&&this.$timeout(function(){a.to instanceof Date||(a.to=new Date(a.to)),a.countDownDate=a.to.getTime(),document.getElementById("timer_"+a.uid).classList.remove("timer-expired"),a.calculateTime(),a.resetCalculateInterval(1e3),a.$scope.$on("$destroy",function(){clearInterval(a.interval)})})},a.prototype.resetCalculateInterval=function(a){var b=this;clearInterval(this.interval),this.interval=setInterval(function(){b.calculateTime()},a),this.intervalMs=a},a.prototype.calculateTime=function(){var a=(new Date).getTime(),b=this.countDownDate-a,c=Math.floor(b/864e5),d=Math.floor(b%864e5/36e5),e=Math.floor(b%36e5/6e4),f=Math.floor(b%6e4/1e3);c>0?(this.updateTimer(c+" "+this.$translate.getTranslation(1===c?"day":"days")),this.resetCalculateInterval(6e4)):d>0?this.updateTimer(this.pad(d,2)+":"+this.pad(e,2)+":"+this.pad(f,2)):(this.updateTimer(this.pad(e,2)+":"+this.pad(f,2)),this.intervalMs>1e3&&this.resetCalculateInterval(1e3)),b<0&&(clearInterval(this.interval),this.updateTimer("<strong>00:00</strong>"),document.getElementById("timer_"+this.uid).classList.add("timer-expired"))},a.prototype.pad=function(a,b){return("00"+a).substr(-b)},a.prototype.updateTimer=function(a){document.getElementById("timer_"+this.uid).innerHTML=a},a.$inject=["$scope","$element","$timeout","$routeParams","$location","$animate","$translate"],a}();a.TimerDirectiveController=b;var c=function(){function a(){this.restrict="E",this.template='<span id="timer_{{ctrl.uid}}"></span>',this.scope={to:"<",uid:"@"},this.controllerAs="ctrl",this.controller=b,this.bindToController=!0,this.link=function(a,b,c,d){d.setupTimer()}}return a}();a.TimerDirective=c}(a.Directives||(a.Directives={}))}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").controller("timerDirectiveController",FT.Widget.Side.Directives.TimerDirectiveController).directive("timer",[function(){return new FT.Widget.Side.Directives.TimerDirective}]);var FT;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(){this.restrict="A"}return a.prototype.link=function(a,b,c){a.$on("$destroy",function(){$("body").off("click.tooltip")});var d=!1,e=$("#tooltip");window.tooltipTimeOut&&clearTimeout(window.tooltipTimeOut),b.off("click mouseenter"),b.on("click mouseenter",function(a){a.stopPropagation(),a.preventDefault();var g=c.title;if(!g||""==g)return f(),!1;clearTimeout(window.tooltipRemover);var h=function(){b.removeAttr("title"),e.html(g),d=!0,clearTimeout(window.tooltipRemover),e.addClass("open")};window.tooltipTimeOut=setTimeout(function(){h()},150),$(window).resize(h),e.off("click"),e.on("click",f),$("body").on("click.tooltip",function(){f()})}),b.off("mouseleave"),b.on("mouseleave",function(){clearTimeout(window.tooltipTimeOut),window.tooltipRemover=setTimeout(function(){f()},200)});var f=function(){d&&(e.removeClass("open"),b.attr("title",e.html()),d=!1)}},a}();a.TooltipDirective=b}(a.Directives||(a.Directives={}))}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").directive("tooltip",function(){return new FT.Widget.Side.Directives.TooltipDirective});var FT;!function(a){!function(a){!function(a){!function(a){function b(){return function(a){return a.charAt(0).toUpperCase()+a.slice(1)}}a.Capitalize=b}(a.Filters||(a.Filters={}))}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").filter("capitalize",FT.Widget.Side.Filters.Capitalize);var FT;!function(a){!function(a){!function(a){!function(a){function b(a){function b(a){switch(a){case"AED":return"AED {0}";case"AUD":case"CAD":case"MXN":case"NZD":case"SGD":case"USD":return"${0}";case"BGN":return"{0} лв.";case"BRL":return"R$ {0}";case"CHF":return"CHF {0}";case"CZK":return"{0} Kč";case"DKK":case"ISK":case"NOK":case"SEK":return"{0} kr";case"EUR":return"€{0}";case"GBP":return"£{0}";case"HKD":return"HK$ {0}";case"HRK":return"{0} kn";case"HUF":return"{0} ft";case"ILS":return"₪ {0}";case"JPY":return"¥ {0}";case"MYR":return"RM {0}";case"PHP":return"₱";case"PLN":return"{0} zł";case"RON":return"{0} lei";case"RUB":return"{0} ₽";case"THB":return"฿{0}";case"TWD":return"NT$ {0}";case"ZAR":return"R {0}";default:return"{0}"}}return function(c,d,e){void 0===e&&(e=!0);var f=a("price",e)(c);return d?(f=b(d).replace("{0}",f),["AED","AUD","CAD","MXN","NZD","SGD","USD","GBP","HKD","ILS","JPY","MYR","PHP","THB","TWD"].some(function(a){return a==d})&&(f=f.replace(",",".")),f):f}}a.CurrencyPrice=b}(a.Filters||(a.Filters={}))}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").filter("currencyPrice",["$filter",function(a){return FT.Widget.Side.Filters.CurrencyPrice(a)}]);var FT;!function(a){!function(a){!function(a){!function(a){function b(){return function(a){if(a){var b=$("<div>"+a+"</div>");return $("a",b).each(function(){$(this).attr("target","_blank")}),b.html()}}}a.ExternalUrlsFilter=b}(a.Filters||(a.Filters={}))}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").filter("externalUrls",function(){return FT.Widget.Side.Filters.ExternalUrlsFilter()});var FT;!function(a){!function(a){!function(a){!function(a){function b(a){return function(b,c,d,e){if(void 0===c&&(c=!1),void 0===d&&(d=!1),void 0===e&&(e=!1),b){b instanceof Date||(b=new Date(b));var f=moment(b);if(!d){var g=f.diff(moment().startOf("day"),"days");if(-1===g)return a.getTranslation("yesterday");if(0===g)return a.getTranslation("today");if(1===g)return a.getTranslation("tomorrow");if(g<7&&g>0)return f.format("dddd");if(g>-7&&g<0)return a.getTranslation("last {0}",f.format("dddd"))}var h=void 0;if(f.year()===moment().year()){var i=a.getCurrentCulture();h="de"===i?"D. MMMM":"es"===i?"D [de] MMMM":"D MMMM"}else h="LL";var j=e?f.format("dddd")+" "+f.format(h):f.format(h);return c?a.getTranslation("on {0}",j):j}}}a.FriendlyDateFilter=b}(a.Filters||(a.Filters={}))}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").filter("friendlyDate",["$translate",function(a){return FT.Widget.Side.Filters.FriendlyDateFilter(a)}]);var FT;!function(a){!function(a){!function(a){!function(a){function b(a){return function(a){if(a){a instanceof Date&&(a=moment(a).format("HH:mm"));var b=a.split(":");return moment().hour(b[0]).minute(b[1]).format("LT")}}}a.FriendlyTimeFilter=b}(a.Filters||(a.Filters={}))}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").filter("friendlyTime",["$routeParams",function(a){return FT.Widget.Side.Filters.FriendlyTimeFilter(a)}]);var FT;!function(a){!function(b){!function(b){!function(b){function c(b){return function(b,c){return a.Helpers.StringHelper.addFilenameSuffix(b,"_"+c)}}b.ImageSize=c}(b.Filters||(b.Filters={}))}(b.Side||(b.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").filter("imageSize",["$parse",function(a){return FT.Widget.Side.Filters.ImageSize(a)}]);var FT;!function(a){!function(a){!function(a){!function(a){function b(){return function(a){return 1==a.length?a[0].day:a.every(function(b,c){return c==a.length-1||a[c+1].dayOfWeek-b.dayOfWeek==1||a[c+1].dayOfWeek-b.dayOfWeek==-6})?a[0].day+" - "+a[a.length-1].day:a.map(function(a){return a.day}).join(" / ")}}a.OpenDaysHeader=b}(a.Filters||(a.Filters={}))}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").filter("openDaysHeader",FT.Widget.Side.Filters.OpenDaysHeader);var FT;!function(a){!function(a){!function(a){!function(a){function b(){return function(a,b){var c=parseInt(a);return c%100!=0||b?(c/100).toFixed(2).replace(".",","):c/100}}a.PriceFilter=b}(a.Filters||(a.Filters={}))}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").filter("price",function(){return FT.Widget.Side.Filters.PriceFilter()});var FT;!function(a){!function(a){!function(a){!function(a){function b(){return function(a,b,c,d){for(var e=d||1,f=b;f<=parseInt(c);f+=e)a.push(f);return a}}a.Range=b}(a.Filters||(a.Filters={}))}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").filter("range",FT.Widget.Side.Filters.Range);var FT;!function(a){!function(b){!function(b){!function(b){function c(b){return function(b){if(b){var c=a.Helpers.DateHelper.dateFromMinutes(new Date,b);return moment(c).format("LT")}}}b.TimeFromMinutesFilter=c}(b.Filters||(b.Filters={}))}(b.Side||(b.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").filter("timeFromMinutes",["$routeParams",function(a){return FT.Widget.Side.Filters.TimeFromMinutesFilter(a)}]);var FT;!function(a){!function(a){!function(a){!function(a){function b(a){return function(b){return a.trustAsHtml(b)}}a.TrustHtml=b}(a.Filters||(a.Filters={}))}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").filter("trustHtml",["$sce",function(a){return FT.Widget.Side.Filters.TrustHtml(a)}]);var FT;!function(a){!function(a){var b=function(){function a(){}return a.getDateArray=function(a,b){for(var c=[],d=a,e=function(a){var b=new Date(this.valueOf());return b.setDate(b.getDate()+a),b};d<=b;)c.push(d),d=e.call(d,1);return c},a.isToday=function(a,b){return moment(this.getRestaurantNow(a)).format("YYYY-MM-DD")==moment(b).format("YYYY-MM-DD")},a.parseDate=function(a){return new Date(a.replace(/-/g,"/"))},a.getWeekDaysForMonth=function(a,b){for(var c=moment(new Date(b,a-1,1)),d=moment(c).endOf("month"),e=moment(c).startOf("isoWeek"),f=moment(d).endOf("isoWeek"),g=[],h=e;h<=f;)g.push(h.toDate()),h=h.clone().add(1,"d");return g},a.getRestaurantNow=function(a){var b=new Date,c=b.getTimezoneOffset()+a.timezoneOffset;return moment(b).add(c,"minutes").toDate()},a.isDST=function(b){var c=new Date(a.lastDayOfMonth(b.getFullYear(),3,"sun").setHours(3)),d=new Date(a.lastDayOfMonth(b.getFullYear(),10,"sun").setHours(3));return b>=c&&b<d},a.lastDayOfMonth=function(a,b,c){for(var d={sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6},e=new Date(a+"/"+b+"/1"),f=b,g=!1;f===b;)g=e.getDay()===d[c]||g,e.setDate(e.getDate()+(g?7:1)),f=e.getMonth()+1;return e.setDate(e.getDate()-7),e},a.timeSpanString=function(a){if(a){var b,c=/([0-9]+?)([A-Za-z])([0-9]{1,4})?/g,d=c.exec(a),e=parseInt(d[1]),f=d[2],g=d[3]?parseInt(d[3]):null;switch(f){case"s":b="second";break;case"m":b="minute";break;case"h":b="hour";break;case"d":b="day";break;case"w":b="week";break;case"M":b="month";break;case"y":b="year"}return e+" "+b+(1==e?"":"s")+(g?" at "+this.timeFromMinutes(g):"")}return""},a.shortTimeSpanString=function(a){if(a){var b=/(\d{1,2})([A-Za-z]{1})(\d{2,4})?/g,c=b.exec(a),d=parseInt(c[1]),e=c[2],f=c[3]?parseInt(c[3]):null;return d+e+(f?" ("+this.timeFromMinutes(f)+")":"")}return""},a.timeSpanToMinutes=function(a){if(a){var b=/(\d{1,2})([A-Za-z]{1})(\d{2,4})?/g,c=b.exec(a),d=parseInt(c[1]),e=c[2];c[3]&&parseInt(c[3]);return moment.duration(d,e).asMinutes()}return 0},a.minutesFromMidnight=function(a){a=new Date(a);var b=new Date(a);return b.setHours(0,0,0,0),(a-b)/6e4},a.dateFromMinutes=function(a,b){return a=new Date(a),a.setHours(Math.floor(b/60),b%60,0),a},a.minutesFromTime=function(a){var b=a.split(":");return 60*parseInt(b[0])+parseInt(b[1])},a.secondsFromDate=function(a){return 3600*a.getHours()+60*a.getMinutes()+a.getSeconds()},a.minutesFromDate=function(a){return 60*a.getHours()+a.getMinutes()},a.timeFromMinutes=function(a){var b=new Date;return b.setHours(Math.floor(a/60),a%60,0),moment(b).format("HH:mm")},a}();a.DateHelper=b}(a.Helpers||(a.Helpers={}))}(FT||(FT={}));var FT;!function(a){!function(a){var b=function(){function a(){}return a.storageAvailable=function(a){try{var b=window[a],c="__storage_test__";return b.setItem(c,c),b.removeItem(c),!0}catch(a){return!1}},a}();a.StorageHelper=b}(a.Helpers||(a.Helpers={}))}(FT||(FT={}));var FT;!function(a){!function(a){var b=function(){function a(){}return a.addFilenameSuffix=function(a,b){if(!a)return"";if(!b)return a;var c=a,d="",e="",f="",g=c.indexOf("?");-1!==g?(f=c.substring(g),e=c.substring(0,g)):e=c;var h=e.lastIndexOf("/");-1!==h&&(d=e.substring(0,h),e=e.substring(h));var i=e.lastIndexOf(".");return-1!==i?e=e.substring(0,i)+b+e.substring(i):e+=b,d+e+f},a}()
;a.StringHelper=b}(a.Helpers||(a.Helpers={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(){this.title="",this.source="Widget",this.culture="en",this.sendFeedbackMail=!0,this.newsletter=!1,this.comments="",this.color="#3edca8",this.walkIn=!1,this.companyName="",this.company=!1,this.bookingDuration=0,this.short=!1}return a}();a.Booking=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(){}return a}();a.BookingDate=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(){}return a}();a.BookingTime=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(){}return a}();a.CreateBookingModel=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(){}return a}();a.CreateBookingResultModel=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(){}return a}();a.CreateOrderResultModel=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(){this.quantity=1}return a}();a.CreateProductOrderModel=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(){this.items=[]}return a}();a.CreateTakeAwayOrderModel=b;var c=function(){function a(){}return a}();a.OrderItem=c}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(){}return a}();a.FinishBookingModel=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(){}return a}();a.Issuer=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(){}return a}();a.Option=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(){}return a}();a.OptionAcceptModel=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(){}return a}();a.OptionAcceptResultModel=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(){}return a}();a.Order=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(){this.title="",this.source="Widget",this.culture="en",this.comments="",this.companyName="",this.company=!1,this.address="",this.zipcode="",this.city="",this.newsletter=!1}return a}();a.OrderInfo=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(){}return a}();a.OrderProduct=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(){}return a}();a.OrderTicket=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(){}return a}();a.PaymentMethod=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(){this.quantity=0}return a}();a.Product=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(){}return a}();a.Restaurant=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(){}return a}();a.Search=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(){}return a}();a.SearchProduct=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(){}return a}();a.TakeAway=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(){}return a}();a.TakeAwayDate=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d){this.takeAwayMethod=a,this.comments=b,this.preferredTime=c,this.date=d}return a}();a.TakeAwayInfo=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(){}return a}();a.TakeAwayOrder=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(){}return a}();a.TakeAwaySettings=b;var c=function(){function a(){}return a}();a.TakeAwayDay=c}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(){}return a}();a.TakeAwayTimes=b;var c=function(){function a(){}return a}();a.TakeAwayTime=c}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(){}return a}();a.TranslationSet=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(){}return a}();a.Voucher=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(){this.message="",this.sendAt=null}return a}();a.VoucherInfo=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var FT;!function(a){!function(a){!function(a){var b=function(){function a(){}return a}();a.VoucherSettings=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={}));var __spreadArrays=this&&this.__spreadArrays||function(){for(var a=0,b=0,c=arguments.length;b<c;b++)a+=arguments[b].length;for(var d=Array(a),e=0,b=0;b<c;b++)for(var f=arguments[b],g=0,h=f.length;g<h;g++,e++)d[e]=f[g];return d},FT;!function(a){!function(a){var b=function(){function a(){var b=this;this.$get=["$rootScope",function(d){return null!=a.service?a.service:(a.service=new c(d),a.service.logging=b.logging,a.service.connectionUrl=b.connectionUrl,a.service.init(),a.service)}],this.logging=!1}return a.prototype.setLogging=function(a){this.logging=a},a.prototype.setConnectionUrl=function(a){this.connectionUrl=a},a.service=null,a}();a.SignalRServiceProvider=b;var c=function(){function a(a){this.$rootScope=a,this.events=[],this.subscriptions=[]}return a.prototype.init=function(){this.connectionUrl=this.connectionUrl||"/widget-hub",this.connect(),this.keepAlive()},a.prototype.invoke=function(a){for(var b,c=[],d=1;d<arguments.length;d++)c[d-1]=arguments[d];return this.hubStarted?(b=this.hubConnection).invoke.apply(b,__spreadArrays([a],c)):new Promise(function(a){a()})},a.prototype.addListener=function(a,b,c){var d=this,e={senderId:b,method:c},f=this.getEventRegistration(a);null==f?(f={event:a,connected:!1,listeners:[e]},this.events.push(f)):(this.removeListenerWithSender(f,b),f.listeners.push(e)),this.logToConsole("Listener for "+a+" (sender: "+b+") registered."),this.hubStarted&&(f.connected||(this.logToConsole("Event "+a+" added to hub."),this.hubConnection.on(a,function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];d.invokeListenersForEvent.apply(d,__spreadArrays([a],b))}),f.connected=!0))},a.prototype.removeListener=function(a,b){var c=this.getEventRegistration(a);if(null!=c){this.removeListenerWithSender(c,b);c.listeners.length>0||(this.logToConsole("Event "+a+" removed from hub"),this.hubConnection.off(a),this.events=this.events.filter(function(b){return b.event!==a})),this.logToConsole("Listener for "+a+" and "+b+" removed.")}},a.prototype.subscribe=function(a,b){if(this.subscriptions.filter(function(b){return b.groupName===a}).length)return void this.logToConsole("Subscription already exists");var c={groupName:a,onReconnect:b,connected:!1};this.subscriptions.push(c),this.logToConsole("Subscription for "+a+" registered."),this.hubStarted&&(this.invoke("subscribe",a),c.connected=!0,this.logToConsole("Subscription for "+a+" added to hub."))},a.prototype.unSubscribe=function(a){this.hubStarted&&(this.invoke("unSubscribe",a),this.logToConsole("Unsubscribed for "+a)),this.subscriptions=this.subscriptions.filter(function(b){return b.groupName!==a})},a.prototype.connect=function(){var a=this;return this.hubConnection=(new signalR.HubConnectionBuilder).withUrl(this.connectionUrl).configureLogging(this.logging?signalR.LogLevel.Information:signalR.LogLevel.Error).build(),this.hubConnection.onclose(function(b){null!=b?a.logToConsole("Close event raised: "+b.name+" - "+b.message,new Date):a.logToConsole("Close event raised.",new Date),a.onConnectionClosed()}),this.hubConnection.start().then(function(){return a.hubStarted=!0,a.connectRegisteredEvents(),a.connectRegisteredSubscriptions().then(function(){a.logToConsole("SignalR connected and registered.")})},function(b){a.logToConsole("Error connecting: "+b),a.onConnectionClosed()})},a.prototype.onConnectionClosed=function(){this.hubConnection=null,this.hubStarted=!1,this.events.forEach(function(a){a.connected=!1}),this.subscriptions.forEach(function(a){a.connected=!1}),this.startHeartBeat()},a.prototype.keepAlive=function(){var a=this;document.addEventListener("visibilitychange",function(){document.hidden?(a.logToConsole("document hidden"),a.startHeartBeat()):a.logToConsole("document visible")},!1)},a.prototype.reConnect=function(){this.hubConnection||(this.logToConsole("Reconnecting signalR"),this.stopHeartBeat(),this.connect())},a.prototype.startHeartBeat=function(){var a=this;this.heartbeat||(this.stopHeartBeat(),this.logToConsole("starting heartbeat"),this.heartbeat=window.setInterval(function(){a.reConnect()},6e4))},a.prototype.stopHeartBeat=function(){this.heartbeat&&(this.logToConsole("stopping heartbeat"),window.clearInterval(this.heartbeat),this.heartbeat=null)},a.prototype.invokeListenersForEvent=function(a){for(var b=this,c=[],d=1;d<arguments.length;d++)c[d-1]=arguments[d];var e=this.getEventRegistration(a);null!=e&&e.listeners.forEach(function(d){d.method.apply(d,c),b.$rootScope.$apply(),b.logToConsole("Listener "+a+" for "+d.senderId+" INVOKED")})},a.prototype.connectRegisteredSubscriptions=function(){var a=this,b=this.subscriptions.filter(function(a){return!1===a.connected}).map(function(b){return a.invoke("subscribe",b.groupName).then(function(){a.logToConsole("Subscription for "+b.groupName+" added to hub."),b.connected=!0,b.onReconnect&&(b.onReconnect(),a.$rootScope.$apply())})});return 0===b.length?new Promise(function(a){a()}):Promise.all(b).then(function(){})},a.prototype.connectRegisteredEvents=function(){var a=this;this.events.forEach(function(b){b.connected||(a.hubConnection.on(b.event,function(){for(var c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];a.invokeListenersForEvent.apply(a,__spreadArrays([b.event],c))}),a.logToConsole("Event "+b.event+" added to hub."),b.connected=!0)})},a.prototype.getSubscription=function(a){var b=this.subscriptions.filter(function(b){return b.groupName===a});return 1===b.length?b[0]:null},a.prototype.getEventRegistration=function(a){var b=this.events.filter(function(b){return b.event===a});return 1===b.length?b[0]:null},a.prototype.removeListenerWithSender=function(a,b){for(var c=a.listeners.length-1;c>=0;--c)a.listeners[c]&&a.listeners[c].senderId===b&&a.listeners.splice(c,1)},a.prototype.logToConsole=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];this.logging&&(b.length?console.log(a,b):console.log(a))},a}();a.SignalRService=c}(a.Signal||(a.Signal={}))}(FT||(FT={})),angular.module("ft.signal",[]).provider("signalRService",FT.Signal.SignalRServiceProvider);var __spreadArrays=this&&this.__spreadArrays||function(){for(var a=0,b=0,c=arguments.length;b<c;b++)a+=arguments[b].length;for(var d=Array(a),e=0,b=0;b<c;b++)for(var f=arguments[b],g=0,h=f.length;g<h;g++,e++)d[e]=f[g];return d},FT;!function(a){!function(b){!function(b){!function(b){!function(b){function c(a,b){return function(c){for(var d=[],e=1;e<arguments.length;e++)d[e-1]=arguments[e];if(c)return b.trustAsHtml(a.getTranslation.apply(a,__spreadArrays([c],d)))}}function d(a){return function(b){if(b)return a.getPeopleDisplay(b)}}function e(a){return function(b){if(b)return a.getItemsDisplay(b)}}var f=function(){function a(){var a=this;this.$get=["$log","$stateParams","$q",function(b,c,d){return new g(a,b,c,d)}]}return a.prototype.setup=function(a,b,c){this.widgetApiUrl=a,this.translationUrl=b,this.context=c},a}();b.TranslateProvider=f;var g=function(){function b(b,c,d,e){this.translateProvider=b,this.$log=c,this.$stateParams=d,this.$q=e,this.translationSet=new a.Widget.Side.TranslationSet;var f=angular.injector(["ng"]);this.$http=f.get("$http")}return b.prototype.getApiPromise=function(a,b){var c=this,d=this.$q.defer();return this.$http.get(this.translateProvider.translationUrl+"/restaurant/"+a+"/"+b+"/"+this.translateProvider.context).then(function(a){var b=a.data;c.translationSet.culture=b.culture,c.translationSet.informal=b.informal,c.translationSet.values=b.values,d.resolve(!0)}).catch(function(e){console.warn("Translation load through CDN failed! Trying direct call..."),console.error(e),c.$http.get(c.translateProvider.widgetApiUrl+"/api/translation/restaurant/"+a+"/"+b+"/"+c.translateProvider.context).then(function(a){var b=a.data;c.translationSet.culture=b.culture,c.translationSet.informal=b.informal,c.translationSet.values=b.values,d.resolve(!0)}).catch(function(a){console.error("Translation load through direct call failed!"),console.error(a),d.resolve(!1)})}),d.promise},b.prototype.getCurrentCulture=function(){return this.$stateParams.culture?this.$stateParams.culture:"en"},b.prototype.getTranslation=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];if(!a||""===a)return"";var d=this.translationSet.values[a];d||(this.$log.info("TRANSLATION MISSING\n                     Key: ["+a+"]\n Translation set culture: ["+this.translationSet.culture+"]\n           State culture: ["+this.$stateParams.culture+"]\n                 Context: ["+this.translateProvider.context+"]\n                Informal: ["+(this.translationSet.informal?"Yes":"No")+"]"),d=a);for(var e=0;e<b.length;e++){var f=new RegExp("\\{"+e+"\\}","gm");d=d.replace(f,b[e])}return d},b.prototype.getPeopleDisplay=function(a){return a+" "+(1===a?this.getTranslation("person"):this.getTranslation("people"))},b.prototype.getItemsDisplay=function(a){return a+" "+(1===a?this.getTranslation("item"):this.getTranslation("items"))},b.$inject=["translateProvider","$log","$stateParams","$q"],b}();b.TranslateService=g,b.TranslateFilter=c,c.$inject=["$translate","$sce"],b.TranslatePeopleFilter=d,d.$inject=["$translate"],b.TranslateItemsFilter=e,e.$inject=["$translate"]}(b.Translate||(b.Translate={}))}(b.Modules||(b.Modules={}))}(b.Side||(b.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("ft.translate",[]).provider("$translate",FT.Widget.Side.Modules.Translate.TranslateProvider).filter("translate",FT.Widget.Side.Modules.Translate.TranslateFilter).filter("translatePeople",FT.Widget.Side.Modules.Translate.TranslatePeopleFilter).filter("translateItems",FT.Widget.Side.Modules.Translate.TranslateItemsFilter);var FT;!function(a){!function(a){!function(a){function b(a){if("string"==typeof a){var c=d(a);c&&(a=c)}if("object"!=typeof a)return a;for(var f in a)if(a.hasOwnProperty(f)){var g=a[f];if("string"==typeof g&&/^\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d(.*)/.test(g)){var h=new Date(g),i=h.getTimezoneOffset()+(e(h)?120:60);a[f]=moment(h).add(i,"minutes").toDate()}else"object"==typeof g&&b(g)}return a}function c(a){if("string"==typeof a){var b=d(a);b&&(a=b)}if("object"!=typeof a)return a;for(var f in a)if(a.hasOwnProperty(f)){var g=a[f];if("string"==typeof g&&/^\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d(.*)/.test(g)){var h=new Date(g),i=h.getTimezoneOffset()+(e(h)?120:60);0!=i&&(a[f]=moment(h).subtract(i,"minutes").toISOString())}else"object"==typeof g&&c(g)}return JSON.stringify(a)}function d(a){try{var b=JSON.parse(a);if(b&&"object"==typeof b)return b}catch(a){}return!1}function e(a){var b=new Date(f(a.getFullYear(),3,"sun").setHours(3)),c=new Date(f(a.getFullYear(),10,"sun").setHours(3));return a>=b&&a<c}function f(a,b,c){for(var d={sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6},e=new Date(a+"/"+b+"/1"),f=b,g=!1;f===b;)g=e.getDay()===d[c]||g,e.setDate(e.getDate()+(g?7:1)),f=e.getMonth()+1;return e.setDate(e.getDate()-7),e}!function(a){a[a.Request=0]="Request",a[a.Response=1]="Response"}(a.XhrType||(a.XhrType={}));var g=function(){function a(a,b,c,d,f,g){var h=g.get("$state");return{request:function(a){for(var b=a.url.split("/"),c=0;c<b.length;c++)if(/^\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d(.*)/.test(b[c])){var d=new Date(b[c]),f=d.getTimezoneOffset()+(e(d)?120:60);0!=f&&(b[c]=moment(d).subtract(f,"minutes").toISOString())}return a.url=b.join("/"),a},requestError:function(b){return d.error("Request error:",b),a.reject(b)},response:function(a){return a},responseError:function(b){return 0==b.status&&d.error("Connection error: "+b.status+" -> ","No connection to formitable available"),b.status>0&&422!==b.status&&(d.error("Response error: "+b.status+" -> ",b.statusText+" -> "+b.data.message),h.go("error",{culture:g.get("$stateParams").culture,uid:g.get("$stateParams").uid,errorMessage:b.data.message,errorCode:b.status})),a.reject(b)}}}return a.$inject=["$q","$rootScope","$timeout","$log","$location","$injector"],a}();a.LoadingInterceptor=g,a.convertDateStringsToLocalDates=b,a.convertDateStringsToUtcString=c,a.tryParseJSON=d,a.isDST=e,a.lastDayOfMonth=f}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").service("loadingInterceptor",FT.Widget.Side.LoadingInterceptor).factory("headerInterceptor",["settings",function(a){return{request:function(b){return a.returnUrl&&(b.headers["ft-returnurl"]=a.returnUrl),b}}}]).config(["$httpProvider",function(a){a.defaults.headers.get||(a.defaults.headers.get={}),a.defaults.transformResponse.push(function(a){return a=FT.Widget.Side.convertDateStringsToLocalDates(a)}),a.defaults.transformRequest.push(function(a){return a=FT.Widget.Side.convertDateStringsToUtcString(a)}),a.defaults.headers.get["If-Modified-Since"]="Mon, 26 Jul 1997 05:00:00 GMT",a.defaults.headers.get["Cache-Control"]="no-cache",a.defaults.headers.get.Pragma="no-cache",a.interceptors.push("loadingInterceptor"),a.interceptors.push("headerInterceptor")}]);var FT;!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d,e,f,g,h){this.$http=a,this.$localStorage=b,this.$state=c,this.$stateParams=d,this.$rootScope=e,this.$interval=f,this.widgetApiUrl=g,this.$location=h,this.widgetUrlBase=this.widgetApiUrl+"/api"}return a.prototype.getRestaurant=function(a){return this.$http.get(this.widgetUrlBase+"/restaurant/"+a)},a.prototype.getVoucherSettings=function(a,b){return this.$http.get(this.widgetUrlBase+"/restaurant/"+a+"/vouchersettings/"+b)},a.prototype.getTakeAwaySettings=function(a,b){return this.$http.get(this.widgetUrlBase+"/restaurant/"+a+"/takeAwaySettings/"+b)},a.prototype.getTakeAwayTimes=function(a,b,c){return this.$http.get(this.widgetUrlBase+"/restaurant/"+a+"/takeAwayTimes/"+b+"/"+c)},a.prototype.getTakeAwayDates=function(a){return this.$http.get(this.widgetUrlBase+"/restaurant/"+a+"/takeAwayDates")},a.prototype.getFirstDateTime=function(a,b,c,d,e,f,g){if(!e)return this.$http.get(this.widgetUrlBase+"/availability/"+a.uid+"/first/"+d+"/"+b+"/"+c);var h=this.widgetUrlBase+"/availability/"+a.uid+"/ticket/first/"+e+"/"+d+"/"+b+"/"+c;return f&&(h=this.updateQueryStringParameter(h,"friendCode",f)),g&&(h=this.updateQueryStringParameter(h,"voucherCode",g)),this.$http.get(h)},a.prototype.getTimesForDay=function(a,b,c,d,e,f,g){if(!e)return this.$http.get(this.widgetUrlBase+"/availability/"+a.uid+"/day/"+b.toJSON()+"/"+c+"/"+d);var h=this.widgetUrlBase+"/availability/"+a.uid+"/ticket/day/"+e+"/"+b.toJSON()+"/"+c+"/"+d;return f&&(h=this.updateQueryStringParameter(h,"friendCode",f)),g&&(h=this.updateQueryStringParameter(h,"voucherCode",g)),this.$http.get(h)},a.prototype.getAvailabilityMonthWeeks=function(a,b,c,d,e,f,g,h){if(!f)return this.$http.get(this.widgetUrlBase+"/availability/"+a.uid+"/monthWeeks/"+b+"/"+c+"/"+d+"/"+e);var i=this.widgetUrlBase+"/availability/"+a.uid+"/ticket/monthWeeks/"+f+"/"+b+"/"+c+"/"+d+"/"+e;return g&&(i=this.updateQueryStringParameter(i,"friendCode",g)),h&&(i=this.updateQueryStringParameter(i,"voucherCode",h)),this.$http.get(i)},a.prototype.searchTickets=function(a,b,c,d,e,f){var g=this.widgetUrlBase+"/product/"+a.uid+"/search/"+b.toJSON()+"/"+c+"/"+d;return e&&(g=this.updateQueryStringParameter(g,"friendCode",e)),f&&(g=this.updateQueryStringParameter(g,"voucherCode",f)),this.$http.get(g)},a.prototype.getRecommendedTickets=function(a,b){return this.$http.get(this.widgetUrlBase+"/product/"+a.uid+"/recommended/"+b)},a.prototype.getPaymentMethods=function(a,b,c){return void 0===c&&(c="TICKET"),this.$http.get(this.widgetUrlBase+"/payments/"+a.uid+"/methods/"+b+"/"+c)},a.prototype.getPaymentUrlForBooking=function(a){return this.$http.get(this.widgetUrlBase+"/payments/url/booking/"+a)},a.prototype.getPaymentUrlForOrder=function(a){return this.$http.get(this.widgetUrlBase+"/payments/url/order/"+a)},a.prototype.getIdealIssuers=function(a){return this.$http.get(this.widgetUrlBase+"/payments/"+a.uid+"/issuers")},a.prototype.getProduct=function(a,b,c,d){void 0===d&&(d=null);var e=this.widgetUrlBase+"/product/"+a+"/"+b+"/"+c;return e=this.updateQueryStringParameter(e,"friendCode",d),this.$http.get(e)},a.prototype.getProducts=function(a,b,c,d){var e=this.widgetUrlBase+"/product/"+a+"/search/type/"+c+"/"+b;return d&&(e=this.updateQueryStringParameter(e,"date",d)),this.$http.get(e)},a.prototype.hasAnyProducts=function(a,b){return void 0===b&&(b=null),this.$http.get(this.widgetUrlBase+"/product/"+a+"/any/"+b)},a.prototype.getVoucher=function(a,b,c){return this.$http.get(this.widgetUrlBase+"/order/"+a.uid+"/"+c+"/getvoucher/"+b)},a.prototype.hasActiveVouchers=function(a){return this.$http.get(this.widgetUrlBase+"/order/"+a+"/hasactivevouchers")},a.prototype.createBooking=function(a,b){return this.$http.post(this.widgetUrlBase+"/booking/"+a.uid,b)},a.prototype.createProductOrder=function(a,b){return this.$http.post(this.widgetUrlBase+"/order/"+a.uid+"/CreateProductOrder",b)},a.prototype.createTakeAwayOrder=function(a,b){return this.$http.post(this.widgetUrlBase+"/order/"+a.uid+"/CreateTakeAwayOrder",b)},a.prototype.acceptOption=function(a,b){return this.$http.put(this.widgetUrlBase+"/booking/option/accept",b)},a.prototype.cancelOption=function(a,b){return this.$http.delete(this.widgetUrlBase+"/booking/option/cancel/"+b)},a.prototype.getOrder=function(a,b){return this.$http.get(this.widgetUrlBase+"/order/"+b)},a.prototype.getBooking=function(a,b){return this.$http.get(this.widgetUrlBase+"/booking/"+b)},a.prototype.getOption=function(a,b){return this.$http.get(this.widgetUrlBase+"/booking/option/"+b)},a.prototype.getVoucherInfoForOrder=function(a,b){return this.$http.get(this.widgetUrlBase+"/order/getVoucherInfo/"+b)},a.prototype.updateQueryStringParameter=function(a,b,c){var d=new RegExp("([?&])"+b+"=.*?(&|$)","i"),e=-1!==a.indexOf("?")?"&":"?";return a.match(d)?a.replace(d,"$1"+b+"="+c+"$2"):a+e+b+"="+c},a.prototype.unsubscribe=function(a,b,c,d,e){return this.$http.put(this.widgetUrlBase+"/campaign/unsubscribe",JSON.stringify({email:a,restaurantUid:b,code:c,culture:d,recipientId:e}))},a.prototype.subscribe=function(a,b,c){return this.$http.put(this.widgetUrlBase+"/campaign/subscribe",JSON.stringify({email:a,restaurantUid:b,culture:c}))},a.prototype.confirmSubscription=function(a,b,c,d){return this.$http.put(this.widgetUrlBase+"/campaign/confirmSubscription",JSON.stringify({email:a,restaurantUid:b,code:c,culture:d}))},a.prototype.registerVisit=function(a,b,c,d){return void 0===d&&(d=""),this.$http.post(this.widgetUrlBase+"/campaign/event/register/visit",JSON.stringify({campaignId:b,restaurantUid:a,recipientId:d,url:c}))},a.$inject=["$http","$localStorage","$state","$stateParams","$rootScope","$interval","widgetApiUrl","$location"],a}();a.ApiService=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").service("apiService",FT.Widget.Side.ApiService);var FT;!function(a){!function(a){!function(a){var b=function(){function b(b,c,d,e,f,g,h,i,j,k,l,m){var n=this;this.settings=b,this.$filter=c,this.$location=d,this.$http=e,this.$localStorage=f,this.$state=g,this.$stateParams=h,this.$rootScope=i,this.$interval=j,this.takeAwayService=k,this.apiService=l,this.cssService=m,this.products=[],this.orderInfo=new a.OrderInfo,this.$rootScope.$watch(function(){return n.preferredDate},function(a,b){if(n.preferredDate){var c=n.takeAwayService.getTakeAwayMethods(n.preferredDate);1==c.length?n.takeAwayMethod=c[0]:2!=c.length||n.takeAwayMethod||(n.takeAwayMethod="pick-up"),n.setPreferredTime()}},!0),this.$rootScope.$watch(function(){return n.takeAwayMethod},function(a,b){n.setPreferredTime()},!0)}return b.prototype.selectTakeAwayMethod=function(a){this.takeAwayMethod=a},b.prototype.getTotalItems=function(){return this.products.map(function(a){return a.quantity}).reduce(function(a,b){return a+b},0)},b.prototype.getTotalAmount=function(){var a=this.products.map(function(a){return a.quantity*a.price}).reduce(function(a,b){return a+b},0);return"delivery"==this.takeAwayMethod&&this.takeAwayService.takeAwaySettings.deliveryCosts&&(null==this.takeAwayService.takeAwaySettings.deliveryCostsThreshold||this.takeAwayService.takeAwaySettings.deliveryCostsThreshold>a)&&this.getTotalItems()>0&&(a+=this.takeAwayService.takeAwaySettings.deliveryCosts),this.paymentMethod&&(a+=this.paymentMethod.paymentFee),a},b.prototype.orderForToday=function(){return moment(this.preferredDate).isSame(new Date,"day")},b.prototype.getTotalWithoutDelivery=function(){return this.products.map(function(a){return a.quantity*a.price}).reduce(function(a,b){return a+b},0)},b.prototype.getProduct=function(a){return this.products.filter(function(b){return b.uid==a})[0]},b.prototype.updateProduct=function(a){var b=this.products.filter(function(b){return b.uid==a.uid})[0];b?b.quantity=a.quantity:this.products.push(a)},b.prototype.setPreferredTime=function(){var a=this;this.takeAwayService.updateTimes(this.preferredDate,this.takeAwayMethod).then(function(b){a.preferredTime=a.takeAwayService.preferredTimeIsAvailable(a.preferredTime)?a.preferredTime:a.takeAwayService.getFirstAvailableTime()})},b.$inject=["settings","$filter","$location","$http","$localStorage","$state","$stateParams","$rootScope","$interval","takeAwayService","apiService","cssService"],b}();a.CartService=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").service("cartService",FT.Widget.Side.CartService);var FT;!function(a){!function(a){!function(a){var b=function(){function b(a,b,c,d,e,f,g,h,i,j,k,l){this.settings=a,this.$filter=b,this.$location=c,this.$http=d,this.$localStorage=e,this.$state=f,this.$stateParams=g,this.$rootScope=h,this.$interval=i,this.widgetService=j,this.apiService=k,this.cssService=l}return b.prototype.createProductOrder=function(b,c,d,e,f,g){var h=this,i=new a.CreateProductOrderModel;return i.orderInfo=b,i.productUid=c,i.quantity=d,i.paymentMethodId=e?e.id:"",i.issuerId=f?f.id:"",i.returnUrl=this.settings.returnUrl,i.source=this.widgetService.source,i.campaignId=this.widgetService.campaignId,i.recipientId=this.widgetService.recipientId,g&&(i.voucherInfo=g),this.apiService.createProductOrder(this.widgetService.restaurant,i).then(function(a){var c=a.data;h.saveLocalOrderData(b),h.$state.go("voucherFinish",{uid:h.$stateParams.uid,order:c.orderUid,culture:h.$stateParams.culture,type:"regular",paymentRequired:!!e})})},b.prototype.createTakeAwayOrder=function(b,c,d,e,f){var g=this,h=new a.CreateTakeAwayOrderModel;return h.orderInfo=b,h.takeAwayInfo=c,d.forEach(function(a){a.quantity>0&&h.items.push(a)}),h.paymentMethodId=e?e.id:"",h.issuerId=f?f.id:"",h.returnUrl=this.settings.returnUrl,h.source=this.widgetService.source,h.campaignId=this.widgetService.campaignId,h.recipientId=this.widgetService.recipientId,this.apiService.createTakeAwayOrder(this.widgetService.restaurant,h).then(function(a){var c=a.data;g.saveLocalOrderData(b,h.takeAwayInfo.takeAwayMethod),g.$state.go("takeAwayFinish",{uid:g.$stateParams.uid,order:c.orderUid,culture:g.$stateParams.culture,type:"regular",paymentRequired:!!e})})},b.prototype.createBooking=function(b,c,d,e,f){var g=this,h=new a.CreateBookingModel;return h.booking=b,h.ticketUid=d?d.uid:"",h.paymentMethodId=e?e.id:"",h.issuerId=f?f.id:"",h.returnUrl=this.settings.returnUrl,h.voucherCode=c,h.source=this.widgetService.source,h.campaignId=this.widgetService.campaignId,h.recipientId=this.widgetService.recipientId,this.widgetService.friendCode&&(h.friendCode=this.widgetService.friendCode),this.apiService.createBooking(this.widgetService.restaurant,h).then(function(a){var c=a.data;g.saveLocalBookingData(b),g.$state.go("finish",{uid:g.$stateParams.uid,culture:g.$stateParams.culture,booking:c.bookingUid,type:"regular",paymentRequired:!!e})})},b.prototype.saveLocalOrderData=function(a,b){void 0===b&&(b=null),this.$localStorage.title=a.title,this.$localStorage.company=a.company?"true":"false",this.$localStorage.companyName=a.companyName,this.$localStorage.firstName=a.firstName,this.$localStorage.lastName=a.lastName,this.$localStorage.email=a.email,this.$localStorage.telephone=a.telephone,null!==b&&"delivery"===b&&(this.$localStorage.address=a.address,this.$localStorage.zipcode=a.zipcode,this.$localStorage.city=a.city)},b.prototype.saveLocalBookingData=function(a){this.$localStorage.title=a.title,this.$localStorage.company=a.company?"true":"false",this.$localStorage.companyName=a.companyName,this.$localStorage.firstName=a.firstName,this.$localStorage.lastName=a.lastName,this.$localStorage.email=a.email,this.$localStorage.telephone=a.telephone},b.$inject=["settings","$filter","$location","$http","$localStorage","$state","$stateParams","$rootScope","$interval","widgetService","apiService","cssService"],b}();a.CheckoutService=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").service("checkoutService",FT.Widget.Side.CheckoutService);var FT;!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d,e,f,g,h){this.$http=a,this.$localStorage=b,this.$state=c,this.$stateParams=d,this.$rootScope=e,this.$interval=f,this.$location=g,this.sdkService=h,this.initialize()}return a.prototype.initialize=function(){this.reset()},a.prototype.full=function(){var a=this;$("body").addClass("fullw"),this.sdkService.call("full",[]),setTimeout(function(){a.sdkService.call("addClass",["fullw-delayed"])},1e3)},a.prototype.small=function(){var a=this;$("body").removeClass("fullw"),this.sdkService.call("small",[]),setTimeout(function(){a.sdkService.call("removeClass",["fullw-delayed"])},1e3)},a.prototype.close=function(a){$("body").removeClass("ft-open"),this.sdkService.call("close",[a||"widget"])},a.prototype.open=function(a){$("body").addClass("ft-open"),this.sdkService.call("open",[a||"widget"])},a.prototype.addClass=function(a){$("body").addClass(a),this.sdkService.call("addClass",[a])},a.prototype.removeClass=function(a){$("body").removeClass(a),this.sdkService.call("removeClass",[a])},a.prototype.setStyle=function(a,b,c){
this.addCSSRule(this.sheet,a,b+":"+c)},a.prototype.reset=function(){var a=this.getSheet("extraStyles","screen");if(a.cssRules.length)for(var b=0;b<a.cssRules.length;b++)a.deleteRule?a.deleteRule(b):a.removeRule&&a.removeRule(b);this.sheet=a},a.prototype.getSheet=function(a,b){var c=document.getElementById(a);if(c)return c.sheet;var d=document.createElement("style");return d.appendChild(document.createTextNode("")),d.type="text/css",d.media=b||"screen",d.id=a,document.head.appendChild(d),d.sheet},a.prototype.getHexBrightness=function(a){var b=a.substring(1),c=parseInt(b,16);return.2126*(c>>16&255)+.7152*(c>>8&255)+.0722*(c>>0&255)},a.prototype.addCSSRule=function(a,b,c){var d=a.cssRules.length;"insertRule"in a?a.insertRule(b+"{"+c+"}",d):"addRule"in a&&a.addRule(b,c,d)},a.prototype.hex2rgb=function(a,b){var c=a.replace("#","");c=c.match(new RegExp("(.{"+c.length/3+"})","g"));for(var d=0;d<c.length;d++)c[d]=parseInt(1==c[d].length?c[d]+c[d]:c[d],16);return void 0!==b&&c.push(b),"rgba("+c.join(",")+")"},a.$inject=["$http","$localStorage","$state","$stateParams","$rootScope","$interval","$location","sdkService"],a}();a.CssService=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").service("cssService",FT.Widget.Side.CssService);var FT;!function(a){!function(a){!function(a){var b=function(){function b(a,b,c,d,e,f,g,h,i,j,k,l){this.settings=a,this.$filter=b,this.$location=c,this.$http=d,this.$localStorage=e,this.$state=f,this.$stateParams=g,this.$rootScope=h,this.$interval=i,this.widgetService=j,this.apiService=k,this.cssService=l}return b.prototype.createTakeAwayOrder=function(b,c,d,e,f,g){var h=this,i=new a.CreateProductOrderModel;return i.orderInfo=b,i.productUid=c,i.quantity=d,i.paymentMethodId=e?e.id:"",i.issuerId=f?f.id:"",i.returnUrl=this.settings.returnUrl,i.source=this.widgetService.source,g&&(i.voucherInfo=g),this.apiService.createProductOrder(this.widgetService.restaurant,i).then(function(a){var c=a.data;h.saveLocalData(b),h.$state.go("voucherFinish",{uid:h.$stateParams.uid,order:c.orderUid,culture:h.$stateParams.culture,type:"regular",paymentRequired:!!e})})},b.prototype.saveLocalData=function(a){this.$localStorage.title=a.title,this.$localStorage.firstName=a.firstName,this.$localStorage.lastName=a.lastName,this.$localStorage.email=a.email,this.$localStorage.telephone=a.telephone},b.$inject=["settings","$filter","$location","$http","$localStorage","$state","$stateParams","$rootScope","$interval","widgetService","apiService","cssService"],b}();a.TakeAwayService=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").service("orderService",FT.Widget.Side.TakeAwayService);var FT;!function(a){!function(a){!function(a){var b=function(){function a(){}return a}();a.MessageOut=b;var c=function(){function a(a,b,c,d){var e=this;this.settings=a,this.$state=b,this.$stateParams=c,this.$timeout=d,window.addEventListener("message",function(a){var b=a.data,c=e[b.method];c&&c.apply(e,b.args)},!1)}return a.prototype.getWidgetId=function(){return"b2_"+this.$stateParams.uid},a.prototype.call=function(a,c){var d=new b;d.address=this.getWidgetId(),d.method=a,d.args=c,parent.postMessage(d,"*")},a.prototype.setReturnUrl=function(a){this.settings.returnUrl=a},a.prototype.open=function(a){$("body").addClass("ft-open")},a.prototype.close=function(a){$("body").removeClass("ft-open")},a.prototype.navigate=function(a,b){var c={uid:this.$stateParams.uid,culture:this.$stateParams.culture};"ticket"===a&&(c.ticketId=b),"voucher"===a&&(c.productUid=b),"voucherCheckout"===a&&(c.productUid=b),"subscribe"===a&&(c.email=b),this.$state.go(a,c)},a.$inject=["settings","$state","$stateParams","$timeout"],a}();a.SdkService=c}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").service("sdkService",FT.Widget.Side.SdkService);var FT;!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d,e,f,g,h,i){this.widgetService=a,this.$state=b,this.$stateParams=c,this.$timeout=d,this.apiService=e,this.cssService=f,this.$q=g,this.$filter=h,this.$translate=i,this.initialize()}return a.prototype.initialize=function(){var a=this;this.getTakeAwaySettings().then(function(b){a.takeAwaySettings=b,a.showOrderBtn=a.takeAwaySettings.enabled,a.takeAwaySettings.enabled&&a.getTakeAwayDates().then(function(b){a.dates=b}),a.showOrderBtn&&a.cssService.addClass("ft-vouchers-active")})},a.prototype.validateZipcode=function(a){return!(this.takeAwaySettings.deliveryZipcodes&&this.takeAwaySettings.deliveryZipcodes.length&&a)||this.takeAwaySettings.deliveryZipcodes.some(function(b){return a.trim().substr(0,b.length)==b})},a.prototype.getFirstPossibleDate=function(){var a=this.$q.defer();return this.getTakeAwayDates().then(function(b){var c=b.filter(function(a){return!a.closed})[0];c?a.resolve(moment(c.date).format("YYYY-MM-DD")):a.reject()}),a.promise},a.prototype.getOpenTimes=function(a){var b=this;if(this.takeAwaySettings)var c=angular.copy(this.takeAwaySettings.days);return c.splice(0,1),c.push(this.takeAwaySettings.days[0]),c.map(function(c){return{dayOfWeek:c.dayOfWeek,day:moment().day(c.dayOfWeek).format("ddd"),times:"delivery"==a?c.deliveryEnabled?b.$filter("timeFromMinutes")(c.deliveryStartTime)+" - "+b.$filter("timeFromMinutes")(c.deliveryEndTime):b.$translate.getTranslation("CLOSED"):c.pickUpEnabled?b.$filter("timeFromMinutes")(c.pickUpStartTime)+" - "+b.$filter("timeFromMinutes")(c.pickUpEndTime):b.$translate.getTranslation("CLOSED")}})},a.prototype.getTakeAwaySettings=function(){var a=this.$q.defer();return this.takeAwaySettings?a.resolve(this.takeAwaySettings):this.apiService.getTakeAwaySettings(this.$stateParams.uid,this.$stateParams.culture).then(function(b){a.resolve(b.data)}),a.promise},a.prototype.getTakeAwayDaySettings=function(a){return this.takeAwaySettings&&this.takeAwaySettings.days.filter(function(b){return b.dayOfWeek==new Date(a).getDay()})[0]},a.prototype.updateTimes=function(a,b){var c=this,d=this.$q.defer();return this.apiService.getTakeAwayTimes(this.$stateParams.uid,a,b).then(function(a){c.times=a.data.times,d.resolve(c.times)}),d.promise},a.prototype.getTakeAwayDates=function(){var a=this.$q.defer();return this.dates&&a.resolve(this.dates),this.apiService.getTakeAwayDates(this.$stateParams.uid).then(function(b){a.resolve(b.data)}),a.promise},a.prototype.getTakeAwayMethods=function(a){var b=[];return this.getTakeAwayDaySettings(a).pickUpEnabled&&b.push("pick-up"),this.getTakeAwayDaySettings(a).deliveryEnabled&&b.push("delivery"),b},a.prototype.timesAvailable=function(){return this.times.some(function(a){return a.isAvailable})},a.prototype.preferredTimeIsAvailable=function(a){return this.times.some(function(b){return b.isAvailable&&b.time==a})},a.prototype.getFirstAvailableTime=function(){var a=this.times.filter(function(a){return a.isAvailable})[0];return a?a.time:null},a.$inject=["widgetService","$state","$stateParams","$timeout","apiService","cssService","$q","$filter","$translate"],a}();a.TakeAwayService=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").service("takeAwayService",FT.Widget.Side.TakeAwayService);var FT;!function(a){!function(a){!function(a){var b=function(){function a(a){this.$translate=a,this.m=6e4,this.h=60*this.m,this.d=24*this.h,this.w=7*this.d}return a.prototype.dateFromNow=function(a,b,c){void 0===a&&(a=0),void 0===b&&(b=0),void 0===c&&(c=0);var d=new Date,e=d.getFullYear(),f=d.getMonth(),g=d.getDate();return new Date(e+a,f+b,g+c)},a.prototype.milliSecondsFromMidnight=function(){var a=new Date;return a.getTime()-a.setHours(0,0,0,0)},a.prototype.milliSecondsToMidnight=function(){var a=new Date;return(new Date).setHours(24,0,0,0)-a.getTime()},a.prototype.getMilliSeconds=function(a,b){if("0"==a)return 0;var c=/(\-{0,1}\d{1,2})([A-Za-z]{0,1})(\d{2,4})?/g,d=c.exec(a),e=parseInt(d[1]),f=d[2];if("m"==f)return e*this.m;if("h"==f)return e*this.h;if("d"==f){if(b)return e*this.d;return this.milliSecondsToMidnight()+(e-1)*this.d}return"w"==f?this.getMilliSeconds(7*e+"d"):void 0},a.prototype.toString=function(a){if(!a)return"";var b=/(\-{0,1}\d{1,2})([A-Za-z]{0,1})(\d{2,4})?/g,c=b.exec(a),d=parseInt(c[1]),e=c[2],f=c[3]?parseInt(c[3]):null,g=d+" "+this.$translate.getTranslation((1===d?"ts_single_":"ts_multiple_")+e);return f&&(g=g+" ("+this.$translate.getTranslation("at")+" "+moment.utc(moment.duration(f,"minutes").asMilliseconds()).format("LT")+")"),g},a.$inject=["$translate"],a}();a.TimeSpanService=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").service("timeSpanService",FT.Widget.Side.TimeSpanService);var FT;!function(a){!function(a){!function(a){var b=function(){function a(a,b,c){this.$stateParams=a,this.apiService=b,this.$q=c,this.initialize()}return a.prototype.initialize=function(){var a=this;this.getVoucherSettings().then(function(b){a.voucherSettings=b})},a.prototype.getVoucherSettings=function(){var a=this.$q.defer();return this.voucherSettings?a.resolve(this.voucherSettings):this.apiService.getVoucherSettings(this.$stateParams.uid,this.$stateParams.culture).then(function(b){a.resolve(b.data)}),a.promise},a.$inject=["$stateParams","apiService","$q"],a}();a.VoucherService=b}(a.Side||(a.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").service("voucherService",FT.Widget.Side.VoucherService);var FT;!function(a){!function(b){!function(b){var c=function(){function c(a,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){this.settings=a,this.$q=c,this.$transitions=d,this.$localStorage=e,this.$state=f,this.$stateParams=g,this.$rootScope=h,this.$timeout=i,this.$interval=j,this.widgetUrl=k,this.$location=l,this.apiService=m,this.cssService=n,this.sdkService=o,this.voucherService=p,this.webUrl=q,this.source="Widget",this.peopleArray=[],this.result=[],this.bookView="suggested",this.booking=new b.Booking,this.booking.numberOfPeople=2,this.booking.culture=this.$stateParams.culture,this.searchParams=new b.Search,this.searchParams.numberOfPeople=2,this.deferredRestaurant=this.$q.defer(),this.noAvailability=!1,this.initialize()}return c.prototype.checkVoucherCode=function(a){var b=this,c=this.$q.defer();return this.restaurantLoaded().then(function(d){b.apiService.getVoucher(d,a,b.$stateParams.culture).then(function(a){a.data?(b.voucher=a.data,b.voucher.ticket&&(b.ticketOnly=!0),c.resolve(!0)):c.resolve(!1)})}),c.promise},c.prototype.hasFeature=function(a){return this.restaurant&&this.restaurant.features.some(function(b){return b===a})},c.prototype.initialize=function(a,b){var c=this;void 0===b&&(b=!1);this.$q.defer();this.settings.returnUrl=this.widgetUrl+"/side/"+this.$stateParams.culture+"/"+this.$stateParams.uid+"/finish",moment.locale(this.$stateParams.culture);var d=a||this.$location.search();if(this.originalSearchParams=d,b||this.handleCampaign(d),this.isOption=this.$stateParams.optionId,this.showToolbar=!0,screen.width<600&&d.mobileToolbar?this.showToolbar="true"===d.mobileToolbar:d.toolbar&&(this.showToolbar="true"===d.toolbar),this.showToolbar||this.cssService.addClass("ft-no-toolbar"),d.tag&&(this.source=d.tag.substring(0,99),this.booking.source=d.tag.substring(0,99)),d.color||(d.color="#000"),this.setColor(d.color),this.color=d.color,d.friendCode&&(this.friendCode=d.friendCode),this.ticketOnly=""==d.ticketOnly,this.embedded=d.embed||""==d.embedded||"1"==d.embedded,this.embedded){if(this.settings.returnUrl=document.referrer.split(/[?#]/)[0],document.referrer.indexOf("ft-booking")>-1){var e=document.referrer.match(/ft-booking=([^&]*)/)[1];this.$state.go("finish",{uid:this.$stateParams.uid,culture:this.$stateParams.culture,booking:e,type:"prepaid"})}if(document.referrer.indexOf("ft-ticket")>-1){var f=document.referrer.match(/ft-ticket=([^&]*)/)[1];this.$state.go("ticket",{uid:this.$stateParams.uid,culture:this.$stateParams.culture,ticketId:f})}if(document.referrer.indexOf("ft-option")>-1){var g=document.referrer.replace(new RegExp("\\bFT.Core.ViewModels.MailTemplates.BookingMail.\\b"),"").match(/ft-option=([^&]*)/)[1];this.$state.go("option",{uid:this.$stateParams.uid,culture:this.$stateParams.culture,optionId:g,accept:!0})}}this.restaurantLoaded().then(function(a){c.showVoucherBtn=c.restaurant.productTypes.some(function(a){return"GIFTVOUCHER"==a}),c.showVoucherBtn&&c.cssService.addClass("ft-vouchers-active")}),this.apiService.hasActiveVouchers(this.$stateParams.uid).then(function(a){c.hasActiveVouchers=a.data,c.hasActiveVouchers&&c.cssService.addClass("show-redeem")}),this.apiService.getRestaurant(this.$stateParams.uid).then(function(d){c.restaurant=d.data,c.deferredRestaurant.resolve(c.restaurant),c.getRecommendedTickets();for(var e=Math.max(c.restaurant.minPartySize,c.restaurant.minSeating);e<=Math.min(c.restaurant.maxPartySize,c.restaurant.maxSeating);e++)c.peopleArray.push(e);c.sdkService.call("event",["ft-widget-ready",{init:!a,widgetUid:c.sdkService.getWidgetId()}],!0),(!c.isOption&&!c.ticketOnly||b)&&c.findFirstOption().then(function(a){c.setupFirstDate(a)},function(a){(a.status=422)&&(c.noAvailability=!0)})})},c.prototype.handleCampaign=function(b){if(!a.Helpers.StorageHelper.storageAvailable("sessionStorage")||!a.Helpers.StorageHelper.storageAvailable("localStorage"))return b.campaignId&&(this.campaignId=b.campaignId),void(b.recipientId&&(this.recipientId=b.recipientId));if(!sessionStorage.getItem("ft-campaignId")){if(b.campaignId)if(this.campaignId=b.campaignId,b.recipientId&&(this.recipientId=b.recipientId),localStorage.getItem("campaign")){var c=JSON.parse(localStorage.getItem("campaign"));c.created<moment().add("day",-30).toDate()&&localStorage.setItem("campaign",JSON.stringify({created:moment().toDate(),recipientId:this.recipientId,id:this.campaignId}))}else localStorage.setItem("campaign",JSON.stringify({created:moment().toDate(),recipientId:this.recipientId,id:this.campaignId}));else if(localStorage.getItem("campaign")){var c=JSON.parse(localStorage.getItem("campaign"));c.created<moment().add("day",-30).toDate()?localStorage.setItem("campaign",null):(this.campaignId=c.id,this.recipientId=c.recipientId)}this.campaignId&&(sessionStorage.setItem("ft-campaignId",this.campaignId),this.apiService.registerVisit(this.$stateParams.uid,this.campaignId,this.$location.url(),this.recipientId))}},c.prototype.findFirstOption=function(){var a=this.$q.defer();return this.apiService.getFirstDateTime(this.restaurant,null,this.$stateParams.culture,null,null,this.friendCode,null).then(function(b){var c=b.data;a.resolve(c)},function(b){a.reject(b)}),a.promise},c.prototype.setupFirstDate=function(b){var c=this;this.searchParams.numberOfPeople=this.booking.numberOfPeople=b.partySize,this.selectedArea=b.area,this.setParams(b,!0),this.$rootScope.$broadcast("searchReady"),this.apiService.getTimesForDay(this.restaurant,new Date(this.dateFromBooking(this.searchParams)),this.searchParams.numberOfPeople,this.$stateParams.culture).then(function(a){c.times=a.data});this.$rootScope.$watch(function(){return c.searchParams.bookingDate},function(a,b){b!==a&&c.apiService.getTimesForDay(c.restaurant,new Date(c.dateFromBooking(c.searchParams)),c.searchParams.numberOfPeople,c.$stateParams.culture).then(function(a){c.times=a.data||[];var b=c.times.filter(function(a){return"UNAVAILABLE"!=a.status});if(b.length){var d=b.filter(function(a){return moment(a.time).format("HH:mm")==c.searchParams.bookingTime});d.length>0?c.setParams(d[0],!1):c.setParams(b[0],!1)}})},!1),this.$rootScope.$watch(function(){return c.searchParams.numberOfPeople},function(a,b){b!==a&&c.apiService.getFirstDateTime(c.restaurant,c.dateFromBooking(c.searchParams),c.$stateParams.culture,c.searchParams.numberOfPeople).then(function(a){var b=a.data;b&&c.setParams(b,!0)})},!1),this.$rootScope.$watch(function(){return c.searchParams},function(a,b){b!==a&&c.searchTickets()},!0),this.$interval(function(){if(a.Helpers.DateHelper.getRestaurantNow(c.restaurant)>new Date(c.dateFromBooking(c.searchParams))){var b=c.times.map(function(a){return a.timeString}),d=b[b.indexOf(c.searchParams.bookingTime)+1];d?c.searchParams.bookingTime=d:c.apiService.getFirstDateTime(c.restaurant,c.dateFromBooking(c.searchParams),c.$stateParams.culture,c.searchParams.numberOfPeople).then(function(a){var b=a.data;c.setParams(b,!0)})}},1e4)},c.prototype.restaurantLoaded=function(){return this.deferredRestaurant.promise},c.prototype.setParams=function(a,b){b&&(this.searchParams.bookingDate=a.time),this.searchParams.bookingTime=a.timeString,this.searchParams.short="SHORT"===a.status||a.showEndTime,this.searchParams.bookingDuration="SHORT"===a.status||a.showEndTime?a.maxDuration:0,this.selectedArea=a.area},c.prototype.setBookingTimes=function(a,b){b&&(this.booking.bookingDate=a.time),this.booking.bookingTime=a.timeString,this.booking.short="SHORT"===a.status||a.showEndTime,this.booking.bookingDuration="SHORT"===a.status||a.showEndTime?a.maxDuration:0,this.selectedArea=a.area},c.prototype.bookingUntilTime=function(a){var b=this.searchParams;if(b){var c=b.bookingTime.split(":"),d=moment(b.bookingDate).hour(parseInt(c[0])).minute(parseInt(c[1]));return moment(d).add("m",a).format("LT")}},c.prototype.setColor=function(a){this.cssService.setStyle('.shop-message:before, .options-header ._option-select a.selected, .show-map .button, .quantity-indicator, .order-summary .large-button, ._select-day .button, .availability-message, .selected-voucher-wrap, .redeem .redeem-wrapper .continue-active-voucher a.continue-voucher-btn, .checkout-summary .checkout-total .redeem-row .button, a.large-button.accent, .redeem-box a.redeem-btn, .vouchers-wrapper .vouchers-intro, input.checkbox:after, .dp-calendar-wrapper .dp-calendar-body .dp-calendar-day a.date-selected:not(.date-past):not(.other-month):after, .widget-footer, .voucher-info a.button, .step-option.selected, .payment-methods .method.selected, .widget-footer .vouchers-footer, .ticket-search-button a span, a.error-btn, .ft-w-recommended-0 .suggested .widget-content, .tooltip .select-btn, table.calendar-days tbody tr td.selected .span-wrap:after, .month-start, .proceed-btn .large-button, .widget-header,.ticket-search,.ticket-checkout-button a,.ticket .ticket-filter, .ticket-tag span, .date-dropdown .large-button, .payment-button, .step-indicator span, .checkout-intro .area-checkout, [type="radio"]:checked, [type="checkbox"]:checked, .ft-interact .ft-interact-wrapper .ft-actions-wrap a .ft-promote-label span',"background",a),this.cssService.setStyle("._finish-icon svg, .widget-footer .about-tickets .creator a svg, .ft-interact .ft-interact-wrapper .ft-symbol a svg","fill",a),this.cssService.setStyle(".error-content-wrapper p a, .time-dropdown .dropdown-wrapper .time-option:hover, .time-dropdown .dropdown-wrapper .time-option.time-selected, .people-dropdown .dropdown-wrapper .persons-option:hover, .filtered-bottom-bar .end-time span","color",a),this.cssService.setStyle(".voucher-item.order-product.-product-selected, .step-options .step-option.selected, .checkout-summary .checkout-total .redeem-row input:focus, .billing .billing-type-inputs input:focus, .billing .billing-type-inputs textarea:focus, .payment-methods .method:hover, .payment-methods .method.selected, .time-dropdown .dropdown-wrapper .time-option:hover,.time-dropdown .dropdown-wrapper .time-option.selected, .time-dropdown .dropdown-wrapper .time-option.time-selected, .people-dropdown .dropdown-wrapper .persons-option:hover, .people-dropdown .dropdown-wrapper .persons-option.selected","border-color",a);var b=this.cssService.getHexBrightness(a);b<10&&this.cssService.addClass("dark"),b>220&&this.cssService.addClass("light")},c.prototype.searchTickets=function(){var a=this,b=this.$q.defer();return this.searchParams.bookingDate?(this.searching=!0,this.apiService.searchTickets(this.restaurant,new Date(this.dateFromBooking(this.searchParams)),this.searchParams.numberOfPeople,this.$stateParams.culture,this.friendCode,this.voucher?this.voucher.code:"").then(function(c){a.result=c.data,b.resolve(c.data),a.$timeout(function(){a.searching=!1},300)})):b.resolve(new Array),b.promise},c.prototype.getRecommendedTickets=function(){var a=this;this.recommendedTickets=[],this.apiService.getRecommendedTickets(this.restaurant,this.$stateParams.culture).then(function(b){a.recommendedTickets=b.data,a.recommendedTickets.length<4?a.cssService.addClass("ft-w-recommended-"+a.recommendedTickets.length):a.cssService.addClass("ft-w-recommended-full")})},c.prototype.dateFromBooking=function(a){if(a.bookingTime){var b=a.bookingTime.split(":");return moment(a.bookingDate).hour(parseInt(b[0])).minute(parseInt(b[1])).toISOString()}},c.prototype.getLinkToFormitableLandingPage=function(){var a=this.webUrl+"/welcome";return this.restaurant&&(a+="?ft-restaurant="+this.restaurant.uid),a},c.prototype.home=function(){this.peopleArray=[],this.result=[],this.bookView="suggested",this.booking=new b.Booking,this.booking.numberOfPeople=2,this.booking.culture=this.$stateParams.culture,this.searchParams=new b.Search,this.searchParams.numberOfPeople=2,this.initialize(this.originalSearchParams,!0),this.$state.go("book",{uid:this.$stateParams.uid,culture:this.$stateParams.culture})},c.$inject=["settings","$q","$transitions","$localStorage","$state","$stateParams","$rootScope","$timeout","$interval","widgetUrl","$location","apiService","cssService","sdkService","voucherService","webUrl"],c}();b.WidgetService=c}(b.Side||(b.Side={}))}(a.Widget||(a.Widget={}))}(FT||(FT={})),angular.module("widgetSide").service("widgetService",FT.Widget.Side.WidgetService);